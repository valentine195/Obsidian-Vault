/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};

// src/main.ts
__export(exports, {
  default: () => SettingsSearch
});
var import_obsidian = __toModule(require("obsidian"));

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/main.ts
var SettingsSearch = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "settingsSearchEl", createDiv("settings-search-container vertical-tab-header-group"));
    __publicField(this, "settingsResultsContainerEl", createDiv("settings-search-results-container vertical-tab-content"));
    __publicField(this, "settingsNavItemContainer", this.settingsSearchEl.createDiv("vertical-tab-header-group-items").createDiv("vertical-tab-nav-item settings-search-input"));
    __publicField(this, "settingsResultsEl");
    __publicField(this, "search");
    __publicField(this, "locale");
    __publicField(this, "resources", []);
    __publicField(this, "results", []);
    __publicField(this, "loaded", false);
    __publicField(this, "tabIndex", 0);
    __publicField(this, "pluginTabIndex", 0);
    __publicField(this, "settingCache", new Map());
    __publicField(this, "searchAppended", false);
    __publicField(this, "activeIndex", -1);
    __publicField(this, "activeSetting");
    __publicField(this, "scope", new import_obsidian.Scope(this.app.scope));
    __publicField(this, "mobileContainers", []);
  }
  async onload() {
    (window["SettingsSearch"] = {
      addResources: this.addResources.bind(this),
      removeResources: this.removeResources.bind(this),
      removeTabResources: this.removeTabResources.bind(this)
    }) && this.register(() => delete window["SettingsSearch"]);
    this.app.workspace.onLayoutReady(async () => {
      this.settingsResultsContainerEl.createEl("h3", {
        text: "Settings Search Results"
      });
      this.settingsResultsEl = this.settingsResultsContainerEl.createDiv("settings-search-results");
      this.buildScope();
      this.buildSearch();
      this.buildResources();
      this.buildPluginResources();
      this.patchSettings();
      this.loaded = true;
      this.app.workspace.trigger("settings-search-loaded");
    });
  }
  buildResources() {
    const tab = this.app.setting.settingTabs[this.tabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.tabIndex++;
      setTimeout(() => this.buildResources());
    }
  }
  buildPluginResources() {
    const tab = this.app.setting.pluginTabs[this.pluginTabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.pluginTabIndex++;
      setTimeout(() => this.buildPluginResources());
    }
  }
  get manifests() {
    return Object.values(this.app.plugins.manifests);
  }
  addResourceToCache(resource) {
    if (!resource || !resource.text || !resource.name || !resource.tab) {
      return new Error("A valid resource must be provided.");
    }
    let name;
    if (resource.external) {
      name = createFragment((el) => {
        (0, import_obsidian.setIcon)(el.createSpan({
          attr: {
            "aria-label": "This setting was added by another plugin."
          }
        }), "info");
        el.createSpan({ text: resource.text });
      });
    } else {
      name = resource.name;
    }
    const setting = new import_obsidian.Setting(createDiv()).setName(name).setDesc(createFragment((e) => e.createDiv().innerHTML = resource.desc ?? ""));
    if (resource.external) {
      setting.settingEl.addClass("set-externally");
    }
    if (resource.tab == "community-plugins") {
      let plugin = this.manifests.find((p) => p.name == resource.text);
      if (plugin && this.app.plugins.getPlugin(plugin.id)?._loaded && this.app.setting.pluginTabs.find((t) => t.id == plugin.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.id);
          });
        });
      }
    }
    if (resource.tab == "plugins") {
      const plugins = Object.values(this.app.internalPlugins.plugins);
      const plugin = plugins.find((p) => p._loaded && p.instance.name == resource.text);
      if (plugin && this.app.setting.pluginTabs.find((t) => t.id == plugin.instance.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.instance.id);
          });
        });
      }
    }
    setting.addExtraButton((b) => {
      b.setIcon("forward-arrow").onClick(() => {
        this.showResult(resource);
      });
    });
    this.settingCache.set(resource, setting);
  }
  getResourceFromCache(resource) {
    if (!this.settingCache.has(resource)) {
      this.addResourceToCache(resource);
    }
    return this.settingCache.get(resource);
  }
  removeResourcesFromCache(resources) {
    for (const resource of resources) {
      this.settingCache.delete(resource);
    }
  }
  addResources(...resources) {
    for (const resource of resources) {
      resource.external = true;
      if (this.resources.find((k) => this.equivalent(resource, k)))
        continue;
      this.resources.push(resource);
      this.addResourceToCache(resource);
    }
    return () => this.removeResources(...resources);
  }
  equivalent(resource1, resource2) {
    return resource1.name == resource2.name && resource1.tab == resource2.tab && resource1.text == resource2.text && resource1.desc == resource2.desc && resource1.external == resource2.external;
  }
  removeResources(...resources) {
    const removing = [];
    const keys = [...this.settingCache.keys()];
    for (const resource of resources) {
      if (!resource || !resource.text || !resource.name || !resource.tab) {
        continue;
      }
      resource.external = true;
      this.resources = this.resources.filter((r) => !this.equivalent(resource, r));
      removing.push(...keys.filter((k) => k == resource || this.equivalent(resource, k)));
    }
    this.removeResourcesFromCache(removing);
  }
  removeTabResources(tab) {
    const removing = this.resources.filter((t) => t.tab == tab);
    this.resources = this.resources.filter((t) => t.tab != tab);
    this.removeResourcesFromCache(removing);
  }
  async getTabResources(tab) {
    await tab.display();
    const settings = tab.containerEl.querySelectorAll(".setting-item:not(.setting-item-header)");
    for (const el of Array.from(settings)) {
      const text = el.querySelector(".setting-item-name")?.textContent;
      if (!text)
        continue;
      const desc = el.querySelector(".setting-item-description")?.innerHTML ?? "";
      const resource = {
        tab: tab.id,
        name: tab.name,
        text,
        desc
      };
      this.resources.push(resource);
      this.addResourceToCache(resource);
    }
    if (this.app.setting.activeTab?.id == tab.id)
      return;
    tab.containerEl.detach();
    tab.hide();
  }
  patchSettings() {
    const self = this;
    this.register(around(this.app.setting, {
      onOpen: function(next) {
        return function() {
          next.apply(this);
          if (!import_obsidian.Platform.isMobile)
            self.search.inputEl.focus();
          return next;
        };
      }
    }));
    this.register(around(this.app.setting, {
      addSettingTab: function(next) {
        return function(tab) {
          self.getTabResources(tab);
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      removeSettingTab: function(next) {
        return function(tab) {
          if (this.isPluginSettingTab(tab)) {
            self.removeTabResources(tab.id);
          }
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      openTab: function(next) {
        return function(tab) {
          self.searchAppended = false;
          self.app.keymap.popScope(self.scope);
          return next.call(this, tab);
        };
      },
      openTabById: function(next) {
        return function(tab) {
          self.searchAppended = false;
          self.app.keymap.popScope(self.scope);
          return next.call(this, tab);
        };
      },
      onClose: function(next) {
        return function() {
          if (import_obsidian.Platform.isMobile) {
            self.detach();
          }
          return next.call(this);
        };
      }
    }));
  }
  buildSearch() {
    const tempSetting = new import_obsidian.Setting(createDiv()).addSearch((s) => {
      this.search = s;
    });
    this.settingsNavItemContainer.append(tempSetting.controlEl);
    tempSetting.settingEl.detach();
    this.search.onChange((v) => {
      this.onChange(v);
    });
    this.search.setPlaceholder("Search settings...");
    this.app.setting.tabHeadersEl.prepend(this.settingsSearchEl);
  }
  buildScope() {
    this.scope.register([], "ArrowDown", () => {
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
      }
      this.activeIndex = ((this.activeIndex + 1) % this.results.length + this.results.length) % this.results.length;
      this.centerActiveSetting();
    });
    this.scope.register([], "ArrowUp", () => {
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
      }
      this.activeIndex = ((this.activeIndex - 1) % this.results.length + this.results.length) % this.results.length;
      this.centerActiveSetting();
    });
    this.scope.register([], "Enter", () => {
      if (this.activeSetting) {
        this.showResult(this.results[this.activeIndex]);
      }
    });
  }
  centerActiveSetting() {
    const result = this.results[this.activeIndex];
    this.activeSetting = this.getResourceFromCache(result);
    this.activeSetting.settingEl.addClass("active");
    this.activeSetting.settingEl.scrollIntoView({
      behavior: "auto",
      block: "nearest"
    });
  }
  detachFromMobile() {
    if (import_obsidian.Platform.isMobile) {
      this.settingsResultsContainerEl.detach();
      for (const header of this.mobileContainers) {
        this.app.setting.tabHeadersEl.append(header);
      }
      this.search.setValue("");
    }
  }
  detachFromDesktop() {
    if (import_obsidian.Platform.isDesktop) {
      this.app.setting.openTabById(this.app.setting.lastTabId);
    }
  }
  detach() {
    this.detachFromDesktop();
    this.detachFromMobile();
    this.searchAppended = false;
  }
  onChange(v) {
    if (!v) {
      this.detach();
      this.app.keymap.popScope(this.scope);
      return;
    }
    if (!this.searchAppended) {
      this.activeIndex = -1;
      this.app.keymap.popScope(this.scope);
      this.app.keymap.pushScope(this.scope);
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
        this.activeSetting = null;
      }
      if (!import_obsidian.Platform.isMobile) {
        this.app.setting.activeTab.navEl.removeClass("is-active");
        this.app.setting.tabContentContainer.empty();
        this.app.setting.tabContentContainer.append(this.settingsResultsContainerEl);
      } else {
        const headers = this.app.setting.tabHeadersEl.querySelectorAll(".vertical-tab-header-group:not(.settings-search-container)");
        for (const header of Array.from(headers)) {
          this.mobileContainers.push(header);
          header.detach();
        }
        this.app.setting.tabHeadersEl.append(this.settingsResultsContainerEl);
      }
      this.searchAppended = true;
    }
    this.appendResults(this.performFuzzySearch(v));
  }
  getMatchText(text, result) {
    const matchElements = {};
    return createFragment((content) => {
      for (let i = 0; i < text.length; i++) {
        let match = result.matches.find((m) => m[0] === i);
        if (match) {
          const index = result.matches.indexOf(match);
          if (!matchElements[index]) {
            matchElements[index] = createSpan("suggestion-highlight");
          }
          let element = matchElements[index];
          content.appendChild(element);
          element.appendText(text.substring(match[0], match[1]));
          i += match[1] - match[0] - 1;
          continue;
        }
        content.appendText(text[i]);
      }
    });
  }
  appendResults(results) {
    this.settingsResultsEl.empty();
    if (results.length) {
      const headers = {};
      for (const resource of results) {
        if (!(resource.tab in headers)) {
          headers[resource.tab] = this.settingsResultsEl.createDiv();
          new import_obsidian.Setting(headers[resource.tab]).setHeading().setName(resource.name);
        }
        const setting = this.getResourceFromCache(resource);
        headers[resource.tab].append(setting.settingEl);
      }
    } else {
      this.settingsResultsEl.setText("No results found :(");
    }
  }
  showResult(result) {
    this.search.setValue("");
    const tab = this.app.setting.settingTabs.find((t) => t.id == result.tab) ?? this.app.setting.pluginTabs.find((t) => t.id == result.tab);
    if (!tab) {
      new import_obsidian.Notice("There was an issue opening the setting tab.");
      return;
    }
    this.app.setting.openTabById(tab.id);
    this.app.keymap.popScope(this.scope);
    this.detach();
    try {
      const names = tab.containerEl.querySelectorAll(".setting-item-name");
      const el = Array.from(names).find((n) => n.textContent == result.text);
      if (!el)
        return;
      const setting = el.closest(".setting-item");
      if (!setting)
        return;
      if (tab.id == "obsidian-style-settings") {
        let collapsed = setting.closest(".style-settings-container");
        let previous = collapsed?.previousElementSibling;
        while (previous != null && previous.hasClass("is-collapsed") && previous.hasClass("style-settings-heading")) {
          previous.removeClass("is-collapsed");
          collapsed = collapsed.parentElement?.closest(".style-settings-container");
          previous = collapsed?.previousElementSibling;
        }
      }
      let details = setting.closest("details");
      while (details) {
        details.setAttr("open", "open");
        details = details.parentElement?.closest("details");
      }
      setting.scrollIntoView(true);
      setting.addClass("is-flashing");
      window.setTimeout(() => setting.removeClass("is-flashing"), 3e3);
    } catch (e) {
      console.error(e);
    }
  }
  performFuzzySearch(input) {
    const results = [], hotkeys = [];
    for (const resource of this.resources) {
      let result = (0, import_obsidian.prepareSimpleSearch)(input)(resource.text) ?? (0, import_obsidian.prepareSimpleSearch)(input)(resource.desc);
      if (result) {
        if (resource.tab == "hotkeys") {
          hotkeys.push(resource);
        } else {
          results.push(resource);
        }
      }
    }
    this.results = [...results, ...hotkeys];
    return this.results;
  }
  onunload() {
    this.settingsSearchEl.detach();
    this.settingsResultsEl.detach();
    this.detach();
    if (this.searchAppended && import_obsidian.Platform.isDesktop)
      this.app.setting.openTabById(this.app.setting.lastTabId);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vR2l0SHViL29ic2lkaWFuLXNldHRpbmdzLXNlYXJjaC9zcmMvbWFpbi50cyIsICIuLi8uLi8uLi8uLi9HaXRIdWIvb2JzaWRpYW4tc2V0dGluZ3Mtc2VhcmNoL25vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcbiAgICBQbHVnaW4sXG4gICAgU2VhcmNoQ29tcG9uZW50LFxuICAgIFNldHRpbmcsXG4gICAgU2VhcmNoUmVzdWx0LFxuICAgIE5vdGljZSxcbiAgICBwcmVwYXJlU2ltcGxlU2VhcmNoLFxuICAgIFNldHRpbmdUYWIsXG4gICAgU2NvcGUsXG4gICAgUGxhdGZvcm0sXG4gICAgc2V0SWNvblxufSBmcm9tIFwib2JzaWRpYW5cIjtcblxuaW1wb3J0IHsgYXJvdW5kIH0gZnJvbSBcIm1vbmtleS1hcm91bmRcIjtcblxuZGVjbGFyZSBtb2R1bGUgXCJvYnNpZGlhblwiIHtcbiAgICBpbnRlcmZhY2UgQXBwIHtcbiAgICAgICAgaW50ZXJuYWxQbHVnaW5zOiB7XG4gICAgICAgICAgICBwbHVnaW5zOiBSZWNvcmQ8XG4gICAgICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgICAgIHsgX2xvYWRlZDogYm9vbGVhbjsgaW5zdGFuY2U6IHsgbmFtZTogc3RyaW5nOyBpZDogc3RyaW5nIH0gfVxuICAgICAgICAgICAgPjtcbiAgICAgICAgfTtcbiAgICAgICAgcGx1Z2luczoge1xuICAgICAgICAgICAgbWFuaWZlc3RzOiBSZWNvcmQ8c3RyaW5nLCBQbHVnaW5NYW5pZmVzdD47XG4gICAgICAgICAgICBwbHVnaW5zOiBSZWNvcmQ8c3RyaW5nLCBQbHVnaW4+O1xuICAgICAgICAgICAgZ2V0UGx1Z2luKGlkOiBzdHJpbmcpOiBQbHVnaW47XG4gICAgICAgIH07XG4gICAgICAgIHNldHRpbmc6IHtcbiAgICAgICAgICAgIG9uT3BlbigpOiB2b2lkO1xuICAgICAgICAgICAgb25DbG9zZSgpOiB2b2lkO1xuXG4gICAgICAgICAgICBvcGVuVGFiQnlJZChpZDogc3RyaW5nKTogdm9pZDtcbiAgICAgICAgICAgIG9wZW5UYWIodGFiOiBTZXR0aW5nVGFiKTogdm9pZDtcblxuICAgICAgICAgICAgaXNQbHVnaW5TZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IGJvb2xlYW47XG4gICAgICAgICAgICBhZGRTZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IHZvaWQ7XG4gICAgICAgICAgICByZW1vdmVTZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IHZvaWQ7XG5cbiAgICAgICAgICAgIGFjdGl2ZVRhYjogU2V0dGluZ1RhYjtcbiAgICAgICAgICAgIGxhc3RUYWJJZDogc3RyaW5nO1xuXG4gICAgICAgICAgICBwbHVnaW5UYWJzOiBQbHVnaW5TZXR0aW5nVGFiW107XG4gICAgICAgICAgICBzZXR0aW5nVGFiczogU2V0dGluZ1RhYltdO1xuXG4gICAgICAgICAgICB0YWJDb250ZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIHRhYkhlYWRlcnNFbDogSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGludGVyZmFjZSBQbHVnaW4ge1xuICAgICAgICBfbG9hZGVkOiBib29sZWFuO1xuICAgIH1cbiAgICBpbnRlcmZhY2UgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICB9XG4gICAgaW50ZXJmYWNlIFNldHRpbmdUYWIge1xuICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIG5hdkVsOiBIVE1MRWxlbWVudDtcbiAgICB9XG4gICAgaW50ZXJmYWNlIFdvcmtzcGFjZSB7XG4gICAgICAgIG9uKFxuICAgICAgICAgICAgbmFtZTogXCJzZXR0aW5ncy1zZWFyY2gtbG9hZGVkXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnlcbiAgICAgICAgKTogRXZlbnRSZWY7XG4gICAgfVxufVxuZGVjbGFyZSBnbG9iYWwge1xuICAgIGludGVyZmFjZSBXaW5kb3cge1xuICAgICAgICBTZXR0aW5nc1NlYXJjaD86IHtcbiAgICAgICAgICAgIGFkZFJlc291cmNlczogU2V0dGluZ3NTZWFyY2hbXCJhZGRSZXNvdXJjZXNcIl07XG4gICAgICAgICAgICByZW1vdmVSZXNvdXJjZXM6IFNldHRpbmdzU2VhcmNoW1wicmVtb3ZlUmVzb3VyY2VzXCJdO1xuICAgICAgICAgICAgcmVtb3ZlVGFiUmVzb3VyY2VzOiBTZXR0aW5nc1NlYXJjaFtcInJlbW92ZVRhYlJlc291cmNlc1wiXTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbmludGVyZmFjZSBSZXNvdXJjZSB7XG4gICAgdGFiOiBzdHJpbmc7XG4gICAgLy90YWIgbmFtZVxuICAgIG5hbWU6IHN0cmluZztcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgZGVzYzogc3RyaW5nO1xuICAgIGV4dGVybmFsPzogYm9vbGVhbjtcbn1cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldHRpbmdzU2VhcmNoIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nc1NlYXJjaEVsOiBIVE1MRGl2RWxlbWVudCA9IGNyZWF0ZURpdihcbiAgICAgICAgXCJzZXR0aW5ncy1zZWFyY2gtY29udGFpbmVyIHZlcnRpY2FsLXRhYi1oZWFkZXItZ3JvdXBcIlxuICAgICk7XG4gICAgc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwgPSBjcmVhdGVEaXYoXG4gICAgICAgIFwic2V0dGluZ3Mtc2VhcmNoLXJlc3VsdHMtY29udGFpbmVyIHZlcnRpY2FsLXRhYi1jb250ZW50XCJcbiAgICApO1xuICAgIHNldHRpbmdzTmF2SXRlbUNvbnRhaW5lciA9IHRoaXMuc2V0dGluZ3NTZWFyY2hFbFxuICAgICAgICAuY3JlYXRlRGl2KFwidmVydGljYWwtdGFiLWhlYWRlci1ncm91cC1pdGVtc1wiKVxuICAgICAgICAuY3JlYXRlRGl2KFwidmVydGljYWwtdGFiLW5hdi1pdGVtIHNldHRpbmdzLXNlYXJjaC1pbnB1dFwiKTtcbiAgICBzZXR0aW5nc1Jlc3VsdHNFbDogSFRNTERpdkVsZW1lbnQ7XG4gICAgc2VhcmNoOiBTZWFyY2hDb21wb25lbnQ7XG4gICAgbG9jYWxlOiBzdHJpbmc7XG5cbiAgICByZXNvdXJjZXM6IFJlc291cmNlW10gPSBbXTtcbiAgICByZXN1bHRzOiBSZXNvdXJjZVtdID0gW107XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgICh3aW5kb3dbXCJTZXR0aW5nc1NlYXJjaFwiXSA9IHtcbiAgICAgICAgICAgIGFkZFJlc291cmNlczogdGhpcy5hZGRSZXNvdXJjZXMuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIHJlbW92ZVJlc291cmNlczogdGhpcy5yZW1vdmVSZXNvdXJjZXMuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIHJlbW92ZVRhYlJlc291cmNlczogdGhpcy5yZW1vdmVUYWJSZXNvdXJjZXMuYmluZCh0aGlzKVxuICAgICAgICB9KSAmJiB0aGlzLnJlZ2lzdGVyKCgpID0+IGRlbGV0ZSB3aW5kb3dbXCJTZXR0aW5nc1NlYXJjaFwiXSk7XG5cbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNDb250YWluZXJFbC5jcmVhdGVFbChcImgzXCIsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIlNldHRpbmdzIFNlYXJjaCBSZXN1bHRzXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbCA9IHRoaXMuc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwuY3JlYXRlRGl2KFxuICAgICAgICAgICAgICAgIFwic2V0dGluZ3Mtc2VhcmNoLXJlc3VsdHNcIlxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy5idWlsZFNjb3BlKCk7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkU2VhcmNoKCk7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkUmVzb3VyY2VzKCk7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkUGx1Z2luUmVzb3VyY2VzKCk7XG4gICAgICAgICAgICB0aGlzLnBhdGNoU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIHRoaXMubG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS50cmlnZ2VyKFwic2V0dGluZ3Mtc2VhcmNoLWxvYWRlZFwiKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxvYWRlZCA9IGZhbHNlO1xuICAgIHRhYkluZGV4ID0gMDtcbiAgICBwbHVnaW5UYWJJbmRleCA9IDA7XG4gICAgYnVpbGRSZXNvdXJjZXMoKSB7XG4gICAgICAgIGNvbnN0IHRhYiA9IHRoaXMuYXBwLnNldHRpbmcuc2V0dGluZ1RhYnNbdGhpcy50YWJJbmRleF07XG4gICAgICAgIGlmICh0YWIpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFiUmVzb3VyY2VzKHRhYik7XG4gICAgICAgICAgICB0aGlzLnRhYkluZGV4Kys7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuYnVpbGRSZXNvdXJjZXMoKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYnVpbGRQbHVnaW5SZXNvdXJjZXMoKSB7XG4gICAgICAgIGNvbnN0IHRhYiA9IHRoaXMuYXBwLnNldHRpbmcucGx1Z2luVGFic1t0aGlzLnBsdWdpblRhYkluZGV4XTtcbiAgICAgICAgaWYgKHRhYikge1xuICAgICAgICAgICAgdGhpcy5nZXRUYWJSZXNvdXJjZXModGFiKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luVGFiSW5kZXgrKztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5idWlsZFBsdWdpblJlc291cmNlcygpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbWFuaWZlc3RzKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLmFwcC5wbHVnaW5zLm1hbmlmZXN0cyk7XG4gICAgfVxuICAgIHNldHRpbmdDYWNoZTogTWFwPFJlc291cmNlLCBTZXR0aW5nPiA9IG5ldyBNYXAoKTtcbiAgICBwdWJsaWMgYWRkUmVzb3VyY2VUb0NhY2hlKHJlc291cmNlOiBSZXNvdXJjZSkge1xuICAgICAgICBpZiAoIXJlc291cmNlIHx8ICFyZXNvdXJjZS50ZXh0IHx8ICFyZXNvdXJjZS5uYW1lIHx8ICFyZXNvdXJjZS50YWIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoXCJBIHZhbGlkIHJlc291cmNlIG11c3QgYmUgcHJvdmlkZWQuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG5hbWU6IERvY3VtZW50RnJhZ21lbnQgfCBzdHJpbmc7XG4gICAgICAgIGlmIChyZXNvdXJjZS5leHRlcm5hbCkge1xuICAgICAgICAgICAgbmFtZSA9IGNyZWF0ZUZyYWdtZW50KChlbCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldEljb24oXG4gICAgICAgICAgICAgICAgICAgIGVsLmNyZWF0ZVNwYW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXJpYS1sYWJlbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRoaXMgc2V0dGluZyB3YXMgYWRkZWQgYnkgYW5vdGhlciBwbHVnaW4uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIFwiaW5mb1wiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlbC5jcmVhdGVTcGFuKHsgdGV4dDogcmVzb3VyY2UudGV4dCB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmFtZSA9IHJlc291cmNlLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNyZWF0ZURpdigpKVxuICAgICAgICAgICAgLnNldE5hbWUobmFtZSlcbiAgICAgICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgICAgIGNyZWF0ZUZyYWdtZW50KFxuICAgICAgICAgICAgICAgICAgICAoZSkgPT4gKGUuY3JlYXRlRGl2KCkuaW5uZXJIVE1MID0gcmVzb3VyY2UuZGVzYyA/PyBcIlwiKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIGlmIChyZXNvdXJjZS5leHRlcm5hbCkge1xuICAgICAgICAgICAgc2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJzZXQtZXh0ZXJuYWxseVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzb3VyY2UudGFiID09IFwiY29tbXVuaXR5LXBsdWdpbnNcIikge1xuICAgICAgICAgICAgbGV0IHBsdWdpbiA9IHRoaXMubWFuaWZlc3RzLmZpbmQoKHApID0+IHAubmFtZSA9PSByZXNvdXJjZS50ZXh0KTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBwbHVnaW4gJiZcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5wbHVnaW5zLmdldFBsdWdpbihwbHVnaW4uaWQpPy5fbG9hZGVkICYmXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5wbHVnaW5UYWJzLmZpbmQoKHQpID0+IHQuaWQgPT0gcGx1Z2luLmlkKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBiLnNldFRvb2x0aXAoYE9wZW4gJHtyZXNvdXJjZS50ZXh0fSBTZXR0aW5nc2ApLm9uQ2xpY2soXG4gICAgICAgICAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZChwbHVnaW4uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyZXNvdXJjZS50YWIgPT0gXCJwbHVnaW5zXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbnMgPSBPYmplY3QudmFsdWVzKHRoaXMuYXBwLmludGVybmFsUGx1Z2lucy5wbHVnaW5zKTtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IHBsdWdpbnMuZmluZChcbiAgICAgICAgICAgICAgICAocCkgPT4gcC5fbG9hZGVkICYmIHAuaW5zdGFuY2UubmFtZSA9PSByZXNvdXJjZS50ZXh0XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgcGx1Z2luICYmXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5wbHVnaW5UYWJzLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LmlkID09IHBsdWdpbi5pbnN0YW5jZS5pZFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHNldHRpbmcuYWRkRXh0cmFCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYi5zZXRUb29sdGlwKGBPcGVuICR7cmVzb3VyY2UudGV4dH0gU2V0dGluZ3NgKS5vbkNsaWNrKFxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQocGx1Z2luLmluc3RhbmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXR0aW5nLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJmb3J3YXJkLWFycm93XCIpLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1Jlc3VsdChyZXNvdXJjZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0dGluZ0NhY2hlLnNldChyZXNvdXJjZSwgc2V0dGluZyk7XG4gICAgfVxuICAgIGdldFJlc291cmNlRnJvbUNhY2hlKHJlc291cmNlOiBSZXNvdXJjZSkge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ0NhY2hlLmhhcyhyZXNvdXJjZSkpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkUmVzb3VyY2VUb0NhY2hlKHJlc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5nQ2FjaGUuZ2V0KHJlc291cmNlKTtcbiAgICB9XG4gICAgcmVtb3ZlUmVzb3VyY2VzRnJvbUNhY2hlKHJlc291cmNlczogUmVzb3VyY2VbXSkge1xuICAgICAgICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHJlc291cmNlcykge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nQ2FjaGUuZGVsZXRlKHJlc291cmNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhZGRSZXNvdXJjZXMoLi4ucmVzb3VyY2VzOiBSZXNvdXJjZVtdKSB7XG4gICAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzb3VyY2VzKSB7XG4gICAgICAgICAgICByZXNvdXJjZS5leHRlcm5hbCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5yZXNvdXJjZXMuZmluZCgoaykgPT4gdGhpcy5lcXVpdmFsZW50KHJlc291cmNlLCBrKSkpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB0aGlzLnJlc291cmNlcy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgICAgIHRoaXMuYWRkUmVzb3VyY2VUb0NhY2hlKHJlc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKCkgPT4gdGhpcy5yZW1vdmVSZXNvdXJjZXMoLi4ucmVzb3VyY2VzKTtcbiAgICB9XG4gICAgZXF1aXZhbGVudChyZXNvdXJjZTE6IFJlc291cmNlLCByZXNvdXJjZTI6IFJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICByZXNvdXJjZTEubmFtZSA9PSByZXNvdXJjZTIubmFtZSAmJlxuICAgICAgICAgICAgcmVzb3VyY2UxLnRhYiA9PSByZXNvdXJjZTIudGFiICYmXG4gICAgICAgICAgICByZXNvdXJjZTEudGV4dCA9PSByZXNvdXJjZTIudGV4dCAmJlxuICAgICAgICAgICAgcmVzb3VyY2UxLmRlc2MgPT0gcmVzb3VyY2UyLmRlc2MgJiZcbiAgICAgICAgICAgIHJlc291cmNlMS5leHRlcm5hbCA9PSByZXNvdXJjZTIuZXh0ZXJuYWxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgcmVtb3ZlUmVzb3VyY2VzKC4uLnJlc291cmNlczogUmVzb3VyY2VbXSkge1xuICAgICAgICBjb25zdCByZW1vdmluZyA9IFtdO1xuICAgICAgICBjb25zdCBrZXlzID0gWy4uLnRoaXMuc2V0dGluZ0NhY2hlLmtleXMoKV07XG4gICAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzb3VyY2VzKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgIXJlc291cmNlIHx8XG4gICAgICAgICAgICAgICAgIXJlc291cmNlLnRleHQgfHxcbiAgICAgICAgICAgICAgICAhcmVzb3VyY2UubmFtZSB8fFxuICAgICAgICAgICAgICAgICFyZXNvdXJjZS50YWJcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb3VyY2UuZXh0ZXJuYWwgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZXMgPSB0aGlzLnJlc291cmNlcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgKHIpID0+ICF0aGlzLmVxdWl2YWxlbnQocmVzb3VyY2UsIHIpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmVtb3ZpbmcucHVzaChcbiAgICAgICAgICAgICAgICAuLi5rZXlzLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgKGspID0+IGsgPT0gcmVzb3VyY2UgfHwgdGhpcy5lcXVpdmFsZW50KHJlc291cmNlLCBrKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVSZXNvdXJjZXNGcm9tQ2FjaGUocmVtb3ZpbmcpO1xuICAgIH1cbiAgICByZW1vdmVUYWJSZXNvdXJjZXModGFiOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcmVtb3ZpbmcgPSB0aGlzLnJlc291cmNlcy5maWx0ZXIoKHQpID0+IHQudGFiID09IHRhYik7XG4gICAgICAgIHRoaXMucmVzb3VyY2VzID0gdGhpcy5yZXNvdXJjZXMuZmlsdGVyKCh0KSA9PiB0LnRhYiAhPSB0YWIpO1xuICAgICAgICB0aGlzLnJlbW92ZVJlc291cmNlc0Zyb21DYWNoZShyZW1vdmluZyk7XG4gICAgfVxuICAgIGFzeW5jIGdldFRhYlJlc291cmNlcyh0YWI6IFNldHRpbmdUYWIpIHtcbiAgICAgICAgYXdhaXQgdGFiLmRpc3BsYXkoKTtcblxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRhYi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxEaXZFbGVtZW50PihcbiAgICAgICAgICAgIFwiLnNldHRpbmctaXRlbTpub3QoLnNldHRpbmctaXRlbS1oZWFkZXIpXCJcbiAgICAgICAgKTtcbiAgICAgICAgZm9yIChjb25zdCBlbCBvZiBBcnJheS5mcm9tKHNldHRpbmdzKSkge1xuICAgICAgICAgICAgY29uc3QgdGV4dCA9XG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvcjxIVE1MRGl2RWxlbWVudD4oXG4gICAgICAgICAgICAgICAgICAgIFwiLnNldHRpbmctaXRlbS1uYW1lXCJcbiAgICAgICAgICAgICAgICApPy50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIGlmICghdGV4dCkgY29udGludWU7XG5cbiAgICAgICAgICAgIGNvbnN0IGRlc2MgPVxuICAgICAgICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3I8SFRNTERpdkVsZW1lbnQ+KFwiLnNldHRpbmctaXRlbS1kZXNjcmlwdGlvblwiKVxuICAgICAgICAgICAgICAgICAgICA/LmlubmVySFRNTCA/PyBcIlwiO1xuXG4gICAgICAgICAgICBjb25zdCByZXNvdXJjZSA9IHtcbiAgICAgICAgICAgICAgICB0YWI6IHRhYi5pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiB0YWIubmFtZSxcbiAgICAgICAgICAgICAgICB0ZXh0LFxuICAgICAgICAgICAgICAgIGRlc2NcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnJlc291cmNlcy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgICAgIHRoaXMuYWRkUmVzb3VyY2VUb0NhY2hlKHJlc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hcHAuc2V0dGluZy5hY3RpdmVUYWI/LmlkID09IHRhYi5pZCkgcmV0dXJuO1xuICAgICAgICB0YWIuY29udGFpbmVyRWwuZGV0YWNoKCk7XG4gICAgICAgIHRhYi5oaWRlKCk7XG4gICAgfVxuICAgIHBhdGNoU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXG4gICAgICAgICAgICBhcm91bmQodGhpcy5hcHAuc2V0dGluZywge1xuICAgICAgICAgICAgICAgIG9uT3BlbjogZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQuYXBwbHkodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSBzZWxmLnNlYXJjaC5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vUGF0Y2ggYWRkU2V0dGluZ1RhYiB0byBjYXB0dXJlIGNoYW5nZXMgdG8gcGx1Z2luIHNldHRpbmdzLlxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcbiAgICAgICAgICAgICAgICBhZGRTZXR0aW5nVGFiOiBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogU2V0dGluZ1RhYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5nZXRUYWJSZXNvdXJjZXModGFiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgdGFiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vUGF0Y2ggcmVtb3ZlU2V0dGluZ1RhYiB0byBjYXB0dXJlIGNoYW5nZXMgdG8gcGx1Z2luIHNldHRpbmdzLlxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcbiAgICAgICAgICAgICAgICByZW1vdmVTZXR0aW5nVGFiOiBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogU2V0dGluZ1RhYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbHVnaW5TZXR0aW5nVGFiKHRhYikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZVRhYlJlc291cmNlcyh0YWIuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FsbCh0aGlzLCB0YWIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlcihcbiAgICAgICAgICAgIGFyb3VuZCh0aGlzLmFwcC5zZXR0aW5nLCB7XG4gICAgICAgICAgICAgICAgb3BlblRhYjogZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YWI6IFNldHRpbmdUYWIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoQXBwZW5kZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXBwLmtleW1hcC5wb3BTY29wZShzZWxmLnNjb3BlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgdGFiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9wZW5UYWJCeUlkOiBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogc3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlYXJjaEFwcGVuZGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFwcC5rZXltYXAucG9wU2NvcGUoc2VsZi5zY29wZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMsIHRhYik7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkNsb3NlOiBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBidWlsZFNlYXJjaCgpIHtcbiAgICAgICAgY29uc3QgdGVtcFNldHRpbmcgPSBuZXcgU2V0dGluZyhjcmVhdGVEaXYoKSkuYWRkU2VhcmNoKChzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaCA9IHM7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuc2V0dGluZ3NOYXZJdGVtQ29udGFpbmVyLmFwcGVuZCh0ZW1wU2V0dGluZy5jb250cm9sRWwpO1xuXG4gICAgICAgIHRlbXBTZXR0aW5nLnNldHRpbmdFbC5kZXRhY2goKTtcblxuICAgICAgICB0aGlzLnNlYXJjaC5vbkNoYW5nZSgodikgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZSh2KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2VhcmNoLnNldFBsYWNlaG9sZGVyKFwiU2VhcmNoIHNldHRpbmdzLi4uXCIpO1xuICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkhlYWRlcnNFbC5wcmVwZW5kKHRoaXMuc2V0dGluZ3NTZWFyY2hFbCk7XG4gICAgfVxuXG4gICAgc2VhcmNoQXBwZW5kZWQgPSBmYWxzZTtcbiAgICBhY3RpdmVJbmRleCA9IC0xO1xuICAgIGFjdGl2ZVNldHRpbmc6IFNldHRpbmc7XG4gICAgc2NvcGUgPSBuZXcgU2NvcGUodGhpcy5hcHAuc2NvcGUpO1xuICAgIGJ1aWxkU2NvcGUoKSB7XG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dEb3duXCIsICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVNldHRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcuc2V0dGluZ0VsLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9XG4gICAgICAgICAgICAgICAgKCgodGhpcy5hY3RpdmVJbmRleCArIDEpICUgdGhpcy5yZXN1bHRzLmxlbmd0aCkgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoKSAlXG4gICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRzLmxlbmd0aDtcblxuICAgICAgICAgICAgdGhpcy5jZW50ZXJBY3RpdmVTZXR0aW5nKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkFycm93VXBcIiwgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlU2V0dGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZy5zZXR0aW5nRWwucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID1cbiAgICAgICAgICAgICAgICAoKCh0aGlzLmFjdGl2ZUluZGV4IC0gMSkgJSB0aGlzLnJlc3VsdHMubGVuZ3RoKSArXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0cy5sZW5ndGgpICVcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoO1xuXG4gICAgICAgICAgICB0aGlzLmNlbnRlckFjdGl2ZVNldHRpbmcoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRW50ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlU2V0dGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1Jlc3VsdCh0aGlzLnJlc3VsdHNbdGhpcy5hY3RpdmVJbmRleF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjZW50ZXJBY3RpdmVTZXR0aW5nKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdHNbdGhpcy5hY3RpdmVJbmRleF07XG4gICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZyA9IHRoaXMuZ2V0UmVzb3VyY2VGcm9tQ2FjaGUocmVzdWx0KTtcbiAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcuc2V0dGluZ0VsLnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJlaGF2aW9yOiBcImF1dG9cIixcbiAgICAgICAgICAgIGJsb2NrOiBcIm5lYXJlc3RcIlxuICAgICAgICB9KTtcbiAgICB9XG4gICAgbW9iaWxlQ29udGFpbmVyczogSFRNTEVsZW1lbnRbXSA9IFtdO1xuICAgIGRldGFjaEZyb21Nb2JpbGUoKSB7XG4gICAgICAgIGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNDb250YWluZXJFbC5kZXRhY2goKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaGVhZGVyIG9mIHRoaXMubW9iaWxlQ29udGFpbmVycykge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiSGVhZGVyc0VsLmFwcGVuZChoZWFkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZWFyY2guc2V0VmFsdWUoXCJcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGV0YWNoRnJvbURlc2t0b3AoKSB7XG4gICAgICAgIGlmIChQbGF0Zm9ybS5pc0Rlc2t0b3ApIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQodGhpcy5hcHAuc2V0dGluZy5sYXN0VGFiSWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRldGFjaCgpIHtcbiAgICAgICAgdGhpcy5kZXRhY2hGcm9tRGVza3RvcCgpO1xuICAgICAgICB0aGlzLmRldGFjaEZyb21Nb2JpbGUoKTtcbiAgICAgICAgdGhpcy5zZWFyY2hBcHBlbmRlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBvbkNoYW5nZSh2OiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKCF2KSB7XG4gICAgICAgICAgICB0aGlzLmRldGFjaCgpO1xuICAgICAgICAgICAgdGhpcy5hcHAua2V5bWFwLnBvcFNjb3BlKHRoaXMuc2NvcGUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zZWFyY2hBcHBlbmRlZCkge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IC0xO1xuICAgICAgICAgICAgdGhpcy5hcHAua2V5bWFwLnBvcFNjb3BlKHRoaXMuc2NvcGUpO1xuICAgICAgICAgICAgdGhpcy5hcHAua2V5bWFwLnB1c2hTY29wZSh0aGlzLnNjb3BlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVNldHRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcuc2V0dGluZ0VsLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZyA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLmFjdGl2ZVRhYi5uYXZFbC5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkNvbnRlbnRDb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkNvbnRlbnRDb250YWluZXIuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiSGVhZGVyc0VsLnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTEVsZW1lbnQ+KFxuICAgICAgICAgICAgICAgICAgICAgICAgXCIudmVydGljYWwtdGFiLWhlYWRlci1ncm91cDpub3QoLnNldHRpbmdzLXNlYXJjaC1jb250YWluZXIpXCJcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGhlYWRlciBvZiBBcnJheS5mcm9tKGhlYWRlcnMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9iaWxlQ29udGFpbmVycy5wdXNoKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJIZWFkZXJzRWwuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VhcmNoQXBwZW5kZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXBwZW5kUmVzdWx0cyh0aGlzLnBlcmZvcm1GdXp6eVNlYXJjaCh2KSk7XG4gICAgfVxuICAgIGdldE1hdGNoVGV4dCh0ZXh0OiBzdHJpbmcsIHJlc3VsdDogU2VhcmNoUmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG1hdGNoRWxlbWVudHM6IFJlY29yZDxudW1iZXIsIEhUTUxFbGVtZW50PiA9IHt9O1xuICAgICAgICByZXR1cm4gY3JlYXRlRnJhZ21lbnQoKGNvbnRlbnQpID0+IHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBtYXRjaCA9IHJlc3VsdC5tYXRjaGVzLmZpbmQoKG0pID0+IG1bMF0gPT09IGkpO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHJlc3VsdC5tYXRjaGVzLmluZGV4T2YobWF0Y2gpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1hdGNoRWxlbWVudHNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEVsZW1lbnRzW2luZGV4XSA9IGNyZWF0ZVNwYW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWdnZXN0aW9uLWhpZ2hsaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBlbGVtZW50ID0gbWF0Y2hFbGVtZW50c1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kVGV4dCh0ZXh0LnN1YnN0cmluZyhtYXRjaFswXSwgbWF0Y2hbMV0pKTtcblxuICAgICAgICAgICAgICAgICAgICBpICs9IG1hdGNoWzFdIC0gbWF0Y2hbMF0gLSAxO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb250ZW50LmFwcGVuZFRleHQodGV4dFtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhcHBlbmRSZXN1bHRzKHJlc3VsdHM6IFJlc291cmNlW10pIHtcbiAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbC5lbXB0eSgpO1xuICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIEhUTUxFbGVtZW50PiA9IHt9O1xuICAgICAgICAgICAgZm9yIChjb25zdCByZXNvdXJjZSBvZiByZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEocmVzb3VyY2UudGFiIGluIGhlYWRlcnMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbcmVzb3VyY2UudGFiXSA9IHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuY3JlYXRlRGl2KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgbmV3IFNldHRpbmcoaGVhZGVyc1tyZXNvdXJjZS50YWJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEhlYWRpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldE5hbWUocmVzb3VyY2UubmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZyA9IHRoaXMuZ2V0UmVzb3VyY2VGcm9tQ2FjaGUocmVzb3VyY2UpO1xuXG4gICAgICAgICAgICAgICAgaGVhZGVyc1tyZXNvdXJjZS50YWJdLmFwcGVuZChzZXR0aW5nLnNldHRpbmdFbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBpZiAoXCJob3RrZXlzXCIgaW4gaGVhZGVycykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuYXBwZW5kQ2hpbGQoaGVhZGVyc1tcImhvdGtleXNcIl0pO1xuICAgICAgICAgICAgfSAqL1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbC5zZXRUZXh0KFwiTm8gcmVzdWx0cyBmb3VuZCA6KFwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3dSZXN1bHQocmVzdWx0OiBSZXNvdXJjZSkge1xuICAgICAgICB0aGlzLnNlYXJjaC5zZXRWYWx1ZShcIlwiKTtcbiAgICAgICAgY29uc3QgdGFiID1cbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcuc2V0dGluZ1RhYnMuZmluZCgodCkgPT4gdC5pZCA9PSByZXN1bHQudGFiKSA/P1xuICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5wbHVnaW5UYWJzLmZpbmQoKHQpID0+IHQuaWQgPT0gcmVzdWx0LnRhYik7XG4gICAgICAgIGlmICghdGFiKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiVGhlcmUgd2FzIGFuIGlzc3VlIG9wZW5pbmcgdGhlIHNldHRpbmcgdGFiLlwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQodGFiLmlkKTtcbiAgICAgICAgdGhpcy5hcHAua2V5bWFwLnBvcFNjb3BlKHRoaXMuc2NvcGUpO1xuICAgICAgICB0aGlzLmRldGFjaCgpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lcyA9XG4gICAgICAgICAgICAgICAgdGFiLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2V0dGluZy1pdGVtLW5hbWVcIik7XG4gICAgICAgICAgICBjb25zdCBlbCA9IEFycmF5LmZyb20obmFtZXMpLmZpbmQoXG4gICAgICAgICAgICAgICAgKG4pID0+IG4udGV4dENvbnRlbnQgPT0gcmVzdWx0LnRleHRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIWVsKSByZXR1cm47XG5cbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmcgPSBlbC5jbG9zZXN0KFwiLnNldHRpbmctaXRlbVwiKTtcbiAgICAgICAgICAgIGlmICghc2V0dGluZykgcmV0dXJuO1xuXG4gICAgICAgICAgICBpZiAodGFiLmlkID09IFwib2JzaWRpYW4tc3R5bGUtc2V0dGluZ3NcIikge1xuICAgICAgICAgICAgICAgIGxldCBjb2xsYXBzZWQgPSBzZXR0aW5nLmNsb3Nlc3QoXCIuc3R5bGUtc2V0dGluZ3MtY29udGFpbmVyXCIpO1xuICAgICAgICAgICAgICAgIGxldCBwcmV2aW91cyA9IGNvbGxhcHNlZD8ucHJldmlvdXNFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91cy5oYXNDbGFzcyhcImlzLWNvbGxhcHNlZFwiKSAmJlxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91cy5oYXNDbGFzcyhcInN0eWxlLXNldHRpbmdzLWhlYWRpbmdcIilcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMucmVtb3ZlQ2xhc3MoXCJpcy1jb2xsYXBzZWRcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxhcHNlZCA9IGNvbGxhcHNlZC5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgXCIuc3R5bGUtc2V0dGluZ3MtY29udGFpbmVyXCJcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMgPSBjb2xsYXBzZWQ/LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgZGV0YWlscyA9IHNldHRpbmcuY2xvc2VzdChcImRldGFpbHNcIik7XG4gICAgICAgICAgICB3aGlsZSAoZGV0YWlscykge1xuICAgICAgICAgICAgICAgIGRldGFpbHMuc2V0QXR0cihcIm9wZW5cIiwgXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgIGRldGFpbHMgPSBkZXRhaWxzLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoXCJkZXRhaWxzXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXR0aW5nLnNjcm9sbEludG9WaWV3KHRydWUpO1xuXG4gICAgICAgICAgICBzZXR0aW5nLmFkZENsYXNzKFwiaXMtZmxhc2hpbmdcIik7XG4gICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiBzZXR0aW5nLnJlbW92ZUNsYXNzKFwiaXMtZmxhc2hpbmdcIiksIDMwMDApO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcGVyZm9ybUZ1enp5U2VhcmNoKGlucHV0OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0czogUmVzb3VyY2VbXSA9IFtdLFxuICAgICAgICAgICAgaG90a2V5czogUmVzb3VyY2VbXSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHRoaXMucmVzb3VyY2VzKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID1cbiAgICAgICAgICAgICAgICBwcmVwYXJlU2ltcGxlU2VhcmNoKGlucHV0KShyZXNvdXJjZS50ZXh0KSA/P1xuICAgICAgICAgICAgICAgIHByZXBhcmVTaW1wbGVTZWFyY2goaW5wdXQpKHJlc291cmNlLmRlc2MpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZS50YWIgPT0gXCJob3RrZXlzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgaG90a2V5cy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2gocmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc3VsdHMgPSBbLi4ucmVzdWx0cywgLi4uaG90a2V5c107XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdHM7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3NTZWFyY2hFbC5kZXRhY2goKTtcblxuICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0VsLmRldGFjaCgpO1xuICAgICAgICB0aGlzLmRldGFjaCgpO1xuICAgICAgICBpZiAodGhpcy5zZWFyY2hBcHBlbmRlZCAmJiBQbGF0Zm9ybS5pc0Rlc2t0b3ApXG4gICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKHRoaXMuYXBwLnNldHRpbmcubGFzdFRhYklkKTtcbiAgICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGFyb3VuZChvYmosIGZhY3Rvcmllcykge1xuICAgIGNvbnN0IHJlbW92ZXJzID0gT2JqZWN0LmtleXMoZmFjdG9yaWVzKS5tYXAoa2V5ID0+IGFyb3VuZDEob2JqLCBrZXksIGZhY3Rvcmllc1trZXldKSk7XG4gICAgcmV0dXJuIHJlbW92ZXJzLmxlbmd0aCA9PT0gMSA/IHJlbW92ZXJzWzBdIDogZnVuY3Rpb24gKCkgeyByZW1vdmVycy5mb3JFYWNoKHIgPT4gcigpKTsgfTtcbn1cbmZ1bmN0aW9uIGFyb3VuZDEob2JqLCBtZXRob2QsIGNyZWF0ZVdyYXBwZXIpIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9IG9ialttZXRob2RdLCBoYWRPd24gPSBvYmouaGFzT3duUHJvcGVydHkobWV0aG9kKTtcbiAgICBsZXQgY3VycmVudCA9IGNyZWF0ZVdyYXBwZXIob3JpZ2luYWwpO1xuICAgIC8vIExldCBvdXIgd3JhcHBlciBpbmhlcml0IHN0YXRpYyBwcm9wcyBmcm9tIHRoZSB3cmFwcGluZyBtZXRob2QsXG4gICAgLy8gYW5kIHRoZSB3cmFwcGluZyBtZXRob2QsIHByb3BzIGZyb20gdGhlIG9yaWdpbmFsIG1ldGhvZFxuICAgIGlmIChvcmlnaW5hbClcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGN1cnJlbnQsIG9yaWdpbmFsKTtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yod3JhcHBlciwgY3VycmVudCk7XG4gICAgb2JqW21ldGhvZF0gPSB3cmFwcGVyO1xuICAgIC8vIFJldHVybiBhIGNhbGxiYWNrIHRvIGFsbG93IHNhZmUgcmVtb3ZhbFxuICAgIHJldHVybiByZW1vdmU7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYmVlbiBkZWFjdGl2YXRlZCBhbmQgYXJlIG5vIGxvbmdlciB3cmFwcGVkLCByZW1vdmUgb3Vyc2VsdmVzXG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbCAmJiBvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcilcbiAgICAgICAgICAgIHJlbW92ZSgpO1xuICAgICAgICByZXR1cm4gY3VycmVudC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAvLyBJZiBubyBvdGhlciBwYXRjaGVzLCBqdXN0IGRvIGEgZGlyZWN0IHJlbW92YWxcbiAgICAgICAgaWYgKG9ialttZXRob2RdID09PSB3cmFwcGVyKSB7XG4gICAgICAgICAgICBpZiAoaGFkT3duKVxuICAgICAgICAgICAgICAgIG9ialttZXRob2RdID0gb3JpZ2luYWw7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIG9ialttZXRob2RdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gRWxzZSBwYXNzIGZ1dHVyZSBjYWxscyB0aHJvdWdoLCBhbmQgcmVtb3ZlIHdyYXBwZXIgZnJvbSB0aGUgcHJvdG90eXBlIGNoYWluXG4gICAgICAgIGN1cnJlbnQgPSBvcmlnaW5hbDtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIG9yaWdpbmFsIHx8IEZ1bmN0aW9uKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZGVkdXBlKGtleSwgb2xkRm4sIG5ld0ZuKSB7XG4gICAgY2hlY2tba2V5XSA9IGtleTtcbiAgICByZXR1cm4gY2hlY2s7XG4gICAgZnVuY3Rpb24gY2hlY2soLi4uYXJncykge1xuICAgICAgICByZXR1cm4gKG9sZEZuW2tleV0gPT09IGtleSA/IG9sZEZuIDogbmV3Rm4pLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhZnRlcihwcm9taXNlLCBjYikge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2IsIGNiKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemUoYXN5bmNGdW5jdGlvbikge1xuICAgIGxldCBsYXN0UnVuID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBhZnRlcihsYXN0UnVuLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXN5bmNGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmdzKS50aGVuKHJlcywgcmVqKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgd3JhcHBlci5hZnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGxhc3RSdW4gPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsgYWZ0ZXIobGFzdFJ1biwgcmVzKTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBV087OztBQ1hBLGdCQUFnQixLQUFLLFdBQVc7QUFDbkMsUUFBTSxXQUFXLE9BQU8sS0FBSyxXQUFXLElBQUksU0FBTyxRQUFRLEtBQUssS0FBSyxVQUFVO0FBQy9FLFNBQU8sU0FBUyxXQUFXLElBQUksU0FBUyxLQUFLLFdBQVk7QUFBRSxhQUFTLFFBQVEsT0FBSztBQUFBO0FBQUE7QUFFckYsaUJBQWlCLEtBQUssUUFBUSxlQUFlO0FBQ3pDLFFBQU0sV0FBVyxJQUFJLFNBQVMsU0FBUyxJQUFJLGVBQWU7QUFDMUQsTUFBSSxVQUFVLGNBQWM7QUFHNUIsTUFBSTtBQUNBLFdBQU8sZUFBZSxTQUFTO0FBQ25DLFNBQU8sZUFBZSxTQUFTO0FBQy9CLE1BQUksVUFBVTtBQUVkLFNBQU87QUFDUCxzQkFBb0IsTUFBTTtBQUV0QixRQUFJLFlBQVksWUFBWSxJQUFJLFlBQVk7QUFDeEM7QUFDSixXQUFPLFFBQVEsTUFBTSxNQUFNO0FBQUE7QUFFL0Isb0JBQWtCO0FBRWQsUUFBSSxJQUFJLFlBQVksU0FBUztBQUN6QixVQUFJO0FBQ0EsWUFBSSxVQUFVO0FBQUE7QUFFZCxlQUFPLElBQUk7QUFBQTtBQUVuQixRQUFJLFlBQVk7QUFDWjtBQUVKLGNBQVU7QUFDVixXQUFPLGVBQWUsU0FBUyxZQUFZO0FBQUE7QUFBQTs7O0FEb0RuRCxtQ0FBNEMsdUJBQU87QUFBQSxFQUFuRCxjQXJGQTtBQXFGQTtBQUNJLDRDQUFtQyxVQUMvQjtBQUVKLHNEQUE2QixVQUN6QjtBQUVKLG9EQUEyQixLQUFLLGlCQUMzQixVQUFVLG1DQUNWLFVBQVU7QUFDZjtBQUNBO0FBQ0E7QUFFQSxxQ0FBd0I7QUFDeEIsbUNBQXNCO0FBMEJ0QixrQ0FBUztBQUNULG9DQUFXO0FBQ1gsMENBQWlCO0FBb0JqQix3Q0FBdUMsSUFBSTtBQTJQM0MsMENBQWlCO0FBQ2pCLHVDQUFjO0FBQ2Q7QUFDQSxpQ0FBUSxJQUFJLHNCQUFNLEtBQUssSUFBSTtBQXlDM0IsNENBQWtDO0FBQUE7QUFBQSxRQXJWNUIsU0FBUztBQUNYLElBQUMsUUFBTyxvQkFBb0I7QUFBQSxNQUN4QixjQUFjLEtBQUssYUFBYSxLQUFLO0FBQUEsTUFDckMsaUJBQWlCLEtBQUssZ0JBQWdCLEtBQUs7QUFBQSxNQUMzQyxvQkFBb0IsS0FBSyxtQkFBbUIsS0FBSztBQUFBLFVBQy9DLEtBQUssU0FBUyxNQUFNLE9BQU8sT0FBTztBQUV4QyxTQUFLLElBQUksVUFBVSxjQUFjLFlBQVk7QUFDekMsV0FBSywyQkFBMkIsU0FBUyxNQUFNO0FBQUEsUUFDM0MsTUFBTTtBQUFBO0FBRVYsV0FBSyxvQkFBb0IsS0FBSywyQkFBMkIsVUFDckQ7QUFHSixXQUFLO0FBQ0wsV0FBSztBQUNMLFdBQUs7QUFDTCxXQUFLO0FBQ0wsV0FBSztBQUNMLFdBQUssU0FBUztBQUNkLFdBQUssSUFBSSxVQUFVLFFBQVE7QUFBQTtBQUFBO0FBQUEsRUFNbkMsaUJBQWlCO0FBQ2IsVUFBTSxNQUFNLEtBQUssSUFBSSxRQUFRLFlBQVksS0FBSztBQUM5QyxRQUFJLEtBQUs7QUFDTCxXQUFLLGdCQUFnQjtBQUNyQixXQUFLO0FBQ0wsaUJBQVcsTUFBTSxLQUFLO0FBQUE7QUFBQTtBQUFBLEVBRzlCLHVCQUF1QjtBQUNuQixVQUFNLE1BQU0sS0FBSyxJQUFJLFFBQVEsV0FBVyxLQUFLO0FBQzdDLFFBQUksS0FBSztBQUNMLFdBQUssZ0JBQWdCO0FBQ3JCLFdBQUs7QUFDTCxpQkFBVyxNQUFNLEtBQUs7QUFBQTtBQUFBO0FBQUEsTUFHMUIsWUFBWTtBQUNaLFdBQU8sT0FBTyxPQUFPLEtBQUssSUFBSSxRQUFRO0FBQUE7QUFBQSxFQUduQyxtQkFBbUIsVUFBb0I7QUFDMUMsUUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLFFBQVEsQ0FBQyxTQUFTLFFBQVEsQ0FBQyxTQUFTLEtBQUs7QUFDaEUsYUFBTyxJQUFJLE1BQU07QUFBQTtBQUdyQixRQUFJO0FBQ0osUUFBSSxTQUFTLFVBQVU7QUFDbkIsYUFBTyxlQUFlLENBQUMsT0FBTztBQUMxQixxQ0FDSSxHQUFHLFdBQVc7QUFBQSxVQUNWLE1BQU07QUFBQSxZQUNGLGNBQ0k7QUFBQTtBQUFBLFlBR1o7QUFFSixXQUFHLFdBQVcsRUFBRSxNQUFNLFNBQVM7QUFBQTtBQUFBLFdBRWhDO0FBQ0gsYUFBTyxTQUFTO0FBQUE7QUFFcEIsVUFBTSxVQUFVLElBQUksd0JBQVEsYUFDdkIsUUFBUSxNQUNSLFFBQ0csZUFDSSxDQUFDLE1BQU8sRUFBRSxZQUFZLFlBQVksU0FBUyxRQUFRO0FBRy9ELFFBQUksU0FBUyxVQUFVO0FBQ25CLGNBQVEsVUFBVSxTQUFTO0FBQUE7QUFFL0IsUUFBSSxTQUFTLE9BQU8scUJBQXFCO0FBQ3JDLFVBQUksU0FBUyxLQUFLLFVBQVUsS0FBSyxDQUFDLE1BQU0sRUFBRSxRQUFRLFNBQVM7QUFDM0QsVUFDSSxVQUNBLEtBQUssSUFBSSxRQUFRLFVBQVUsT0FBTyxLQUFLLFdBQ3ZDLEtBQUssSUFBSSxRQUFRLFdBQVcsS0FBSyxDQUFDLE1BQU0sRUFBRSxNQUFNLE9BQU8sS0FDekQ7QUFDRSxnQkFBUSxlQUFlLENBQUMsTUFBTTtBQUMxQixZQUFFLFdBQVcsUUFBUSxTQUFTLGlCQUFpQixRQUMzQyxNQUFNO0FBQ0YsaUJBQUssSUFBSSxRQUFRLFlBQVksT0FBTztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTXhELFFBQUksU0FBUyxPQUFPLFdBQVc7QUFDM0IsWUFBTSxVQUFVLE9BQU8sT0FBTyxLQUFLLElBQUksZ0JBQWdCO0FBQ3ZELFlBQU0sU0FBUyxRQUFRLEtBQ25CLENBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxTQUFTLFFBQVEsU0FBUztBQUdwRCxVQUNJLFVBQ0EsS0FBSyxJQUFJLFFBQVEsV0FBVyxLQUN4QixDQUFDLE1BQU0sRUFBRSxNQUFNLE9BQU8sU0FBUyxLQUVyQztBQUNFLGdCQUFRLGVBQWUsQ0FBQyxNQUFNO0FBQzFCLFlBQUUsV0FBVyxRQUFRLFNBQVMsaUJBQWlCLFFBQzNDLE1BQU07QUFDRixpQkFBSyxJQUFJLFFBQVEsWUFBWSxPQUFPLFNBQVM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1qRSxZQUFRLGVBQWUsQ0FBQyxNQUFNO0FBQzFCLFFBQUUsUUFBUSxpQkFBaUIsUUFBUSxNQUFNO0FBQ3JDLGFBQUssV0FBVztBQUFBO0FBQUE7QUFHeEIsU0FBSyxhQUFhLElBQUksVUFBVTtBQUFBO0FBQUEsRUFFcEMscUJBQXFCLFVBQW9CO0FBQ3JDLFFBQUksQ0FBQyxLQUFLLGFBQWEsSUFBSSxXQUFXO0FBQ2xDLFdBQUssbUJBQW1CO0FBQUE7QUFFNUIsV0FBTyxLQUFLLGFBQWEsSUFBSTtBQUFBO0FBQUEsRUFFakMseUJBQXlCLFdBQXVCO0FBQzVDLGVBQVcsWUFBWSxXQUFXO0FBQzlCLFdBQUssYUFBYSxPQUFPO0FBQUE7QUFBQTtBQUFBLEVBR2pDLGdCQUFnQixXQUF1QjtBQUNuQyxlQUFXLFlBQVksV0FBVztBQUM5QixlQUFTLFdBQVc7QUFDcEIsVUFBSSxLQUFLLFVBQVUsS0FBSyxDQUFDLE1BQU0sS0FBSyxXQUFXLFVBQVU7QUFDckQ7QUFDSixXQUFLLFVBQVUsS0FBSztBQUNwQixXQUFLLG1CQUFtQjtBQUFBO0FBRTVCLFdBQU8sTUFBTSxLQUFLLGdCQUFnQixHQUFHO0FBQUE7QUFBQSxFQUV6QyxXQUFXLFdBQXFCLFdBQXFCO0FBQ2pELFdBQ0ksVUFBVSxRQUFRLFVBQVUsUUFDNUIsVUFBVSxPQUFPLFVBQVUsT0FDM0IsVUFBVSxRQUFRLFVBQVUsUUFDNUIsVUFBVSxRQUFRLFVBQVUsUUFDNUIsVUFBVSxZQUFZLFVBQVU7QUFBQTtBQUFBLEVBR3hDLG1CQUFtQixXQUF1QjtBQUN0QyxVQUFNLFdBQVc7QUFDakIsVUFBTSxPQUFPLENBQUMsR0FBRyxLQUFLLGFBQWE7QUFDbkMsZUFBVyxZQUFZLFdBQVc7QUFDOUIsVUFDSSxDQUFDLFlBQ0QsQ0FBQyxTQUFTLFFBQ1YsQ0FBQyxTQUFTLFFBQ1YsQ0FBQyxTQUFTLEtBQ1o7QUFDRTtBQUFBO0FBRUosZUFBUyxXQUFXO0FBQ3BCLFdBQUssWUFBWSxLQUFLLFVBQVUsT0FDNUIsQ0FBQyxNQUFNLENBQUMsS0FBSyxXQUFXLFVBQVU7QUFFdEMsZUFBUyxLQUNMLEdBQUcsS0FBSyxPQUNKLENBQUMsTUFBTSxLQUFLLFlBQVksS0FBSyxXQUFXLFVBQVU7QUFBQTtBQUk5RCxTQUFLLHlCQUF5QjtBQUFBO0FBQUEsRUFFbEMsbUJBQW1CLEtBQWE7QUFDNUIsVUFBTSxXQUFXLEtBQUssVUFBVSxPQUFPLENBQUMsTUFBTSxFQUFFLE9BQU87QUFDdkQsU0FBSyxZQUFZLEtBQUssVUFBVSxPQUFPLENBQUMsTUFBTSxFQUFFLE9BQU87QUFDdkQsU0FBSyx5QkFBeUI7QUFBQTtBQUFBLFFBRTVCLGdCQUFnQixLQUFpQjtBQUNuQyxVQUFNLElBQUk7QUFFVixVQUFNLFdBQVcsSUFBSSxZQUFZLGlCQUM3QjtBQUVKLGVBQVcsTUFBTSxNQUFNLEtBQUssV0FBVztBQUNuQyxZQUFNLE9BQ0YsR0FBRyxjQUNDLHVCQUNEO0FBQ1AsVUFBSSxDQUFDO0FBQU07QUFFWCxZQUFNLE9BQ0YsR0FBRyxjQUE4Qiw4QkFDM0IsYUFBYTtBQUV2QixZQUFNLFdBQVc7QUFBQSxRQUNiLEtBQUssSUFBSTtBQUFBLFFBQ1QsTUFBTSxJQUFJO0FBQUEsUUFDVjtBQUFBLFFBQ0E7QUFBQTtBQUVKLFdBQUssVUFBVSxLQUFLO0FBQ3BCLFdBQUssbUJBQW1CO0FBQUE7QUFFNUIsUUFBSSxLQUFLLElBQUksUUFBUSxXQUFXLE1BQU0sSUFBSTtBQUFJO0FBQzlDLFFBQUksWUFBWTtBQUNoQixRQUFJO0FBQUE7QUFBQSxFQUVSLGdCQUFnQjtBQUNaLFVBQU0sT0FBTztBQUViLFNBQUssU0FDRCxPQUFPLEtBQUssSUFBSSxTQUFTO0FBQUEsTUFDckIsUUFBUSxTQUFVLE1BQU07QUFDcEIsZUFBTyxXQUFZO0FBQ2YsZUFBSyxNQUFNO0FBQ1gsY0FBSSxDQUFDLHlCQUFTO0FBQVUsaUJBQUssT0FBTyxRQUFRO0FBQzVDLGlCQUFPO0FBQUE7QUFBQTtBQUFBO0FBT3ZCLFNBQUssU0FDRCxPQUFPLEtBQUssSUFBSSxTQUFTO0FBQUEsTUFDckIsZUFBZSxTQUFVLE1BQU07QUFDM0IsZUFBTyxTQUFVLEtBQWlCO0FBQzlCLGVBQUssZ0JBQWdCO0FBQ3JCLGlCQUFPLEtBQUssS0FBSyxNQUFNO0FBQUE7QUFBQTtBQUFBO0FBT3ZDLFNBQUssU0FDRCxPQUFPLEtBQUssSUFBSSxTQUFTO0FBQUEsTUFDckIsa0JBQWtCLFNBQVUsTUFBTTtBQUM5QixlQUFPLFNBQVUsS0FBaUI7QUFDOUIsY0FBSSxLQUFLLG1CQUFtQixNQUFNO0FBQzlCLGlCQUFLLG1CQUFtQixJQUFJO0FBQUE7QUFFaEMsaUJBQU8sS0FBSyxLQUFLLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFNdkMsU0FBSyxTQUNELE9BQU8sS0FBSyxJQUFJLFNBQVM7QUFBQSxNQUNyQixTQUFTLFNBQVUsTUFBTTtBQUNyQixlQUFPLFNBQVUsS0FBaUI7QUFDOUIsZUFBSyxpQkFBaUI7QUFDdEIsZUFBSyxJQUFJLE9BQU8sU0FBUyxLQUFLO0FBQzlCLGlCQUFPLEtBQUssS0FBSyxNQUFNO0FBQUE7QUFBQTtBQUFBLE1BRy9CLGFBQWEsU0FBVSxNQUFNO0FBQ3pCLGVBQU8sU0FBVSxLQUFhO0FBQzFCLGVBQUssaUJBQWlCO0FBQ3RCLGVBQUssSUFBSSxPQUFPLFNBQVMsS0FBSztBQUM5QixpQkFBTyxLQUFLLEtBQUssTUFBTTtBQUFBO0FBQUE7QUFBQSxNQUcvQixTQUFTLFNBQVUsTUFBTTtBQUNyQixlQUFPLFdBQVk7QUFDZixjQUFJLHlCQUFTLFVBQVU7QUFDbkIsaUJBQUs7QUFBQTtBQUVULGlCQUFPLEtBQUssS0FBSztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPckMsY0FBYztBQUNWLFVBQU0sY0FBYyxJQUFJLHdCQUFRLGFBQWEsVUFBVSxDQUFDLE1BQU07QUFDMUQsV0FBSyxTQUFTO0FBQUE7QUFHbEIsU0FBSyx5QkFBeUIsT0FBTyxZQUFZO0FBRWpELGdCQUFZLFVBQVU7QUFFdEIsU0FBSyxPQUFPLFNBQVMsQ0FBQyxNQUFNO0FBQ3hCLFdBQUssU0FBUztBQUFBO0FBRWxCLFNBQUssT0FBTyxlQUFlO0FBQzNCLFNBQUssSUFBSSxRQUFRLGFBQWEsUUFBUSxLQUFLO0FBQUE7QUFBQSxFQU8vQyxhQUFhO0FBQ1QsU0FBSyxNQUFNLFNBQVMsSUFBSSxhQUFhLE1BQU07QUFDdkMsVUFBSSxLQUFLLGVBQWU7QUFDcEIsYUFBSyxjQUFjLFVBQVUsWUFBWTtBQUFBO0FBRTdDLFdBQUssY0FDRSxPQUFLLGNBQWMsS0FBSyxLQUFLLFFBQVEsU0FDcEMsS0FBSyxRQUFRLFVBQ2pCLEtBQUssUUFBUTtBQUVqQixXQUFLO0FBQUE7QUFFVCxTQUFLLE1BQU0sU0FBUyxJQUFJLFdBQVcsTUFBTTtBQUNyQyxVQUFJLEtBQUssZUFBZTtBQUNwQixhQUFLLGNBQWMsVUFBVSxZQUFZO0FBQUE7QUFFN0MsV0FBSyxjQUNFLE9BQUssY0FBYyxLQUFLLEtBQUssUUFBUSxTQUNwQyxLQUFLLFFBQVEsVUFDakIsS0FBSyxRQUFRO0FBRWpCLFdBQUs7QUFBQTtBQUVULFNBQUssTUFBTSxTQUFTLElBQUksU0FBUyxNQUFNO0FBQ25DLFVBQUksS0FBSyxlQUFlO0FBQ3BCLGFBQUssV0FBVyxLQUFLLFFBQVEsS0FBSztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSzlDLHNCQUFzQjtBQUNsQixVQUFNLFNBQVMsS0FBSyxRQUFRLEtBQUs7QUFDakMsU0FBSyxnQkFBZ0IsS0FBSyxxQkFBcUI7QUFDL0MsU0FBSyxjQUFjLFVBQVUsU0FBUztBQUV0QyxTQUFLLGNBQWMsVUFBVSxlQUFlO0FBQUEsTUFDeEMsVUFBVTtBQUFBLE1BQ1YsT0FBTztBQUFBO0FBQUE7QUFBQSxFQUlmLG1CQUFtQjtBQUNmLFFBQUkseUJBQVMsVUFBVTtBQUNuQixXQUFLLDJCQUEyQjtBQUNoQyxpQkFBVyxVQUFVLEtBQUssa0JBQWtCO0FBQ3hDLGFBQUssSUFBSSxRQUFRLGFBQWEsT0FBTztBQUFBO0FBRXpDLFdBQUssT0FBTyxTQUFTO0FBQUE7QUFBQTtBQUFBLEVBRzdCLG9CQUFvQjtBQUNoQixRQUFJLHlCQUFTLFdBQVc7QUFDcEIsV0FBSyxJQUFJLFFBQVEsWUFBWSxLQUFLLElBQUksUUFBUTtBQUFBO0FBQUE7QUFBQSxFQUd0RCxTQUFTO0FBQ0wsU0FBSztBQUNMLFNBQUs7QUFDTCxTQUFLLGlCQUFpQjtBQUFBO0FBQUEsRUFFMUIsU0FBUyxHQUFXO0FBQ2hCLFFBQUksQ0FBQyxHQUFHO0FBQ0osV0FBSztBQUNMLFdBQUssSUFBSSxPQUFPLFNBQVMsS0FBSztBQUM5QjtBQUFBO0FBRUosUUFBSSxDQUFDLEtBQUssZ0JBQWdCO0FBQ3RCLFdBQUssY0FBYztBQUNuQixXQUFLLElBQUksT0FBTyxTQUFTLEtBQUs7QUFDOUIsV0FBSyxJQUFJLE9BQU8sVUFBVSxLQUFLO0FBQy9CLFVBQUksS0FBSyxlQUFlO0FBQ3BCLGFBQUssY0FBYyxVQUFVLFlBQVk7QUFDekMsYUFBSyxnQkFBZ0I7QUFBQTtBQUd6QixVQUFJLENBQUMseUJBQVMsVUFBVTtBQUNwQixhQUFLLElBQUksUUFBUSxVQUFVLE1BQU0sWUFBWTtBQUM3QyxhQUFLLElBQUksUUFBUSxvQkFBb0I7QUFDckMsYUFBSyxJQUFJLFFBQVEsb0JBQW9CLE9BQ2pDLEtBQUs7QUFBQSxhQUVOO0FBQ0gsY0FBTSxVQUNGLEtBQUssSUFBSSxRQUFRLGFBQWEsaUJBQzFCO0FBRVIsbUJBQVcsVUFBVSxNQUFNLEtBQUssVUFBVTtBQUN0QyxlQUFLLGlCQUFpQixLQUFLO0FBQzNCLGlCQUFPO0FBQUE7QUFFWCxhQUFLLElBQUksUUFBUSxhQUFhLE9BQzFCLEtBQUs7QUFBQTtBQUdiLFdBQUssaUJBQWlCO0FBQUE7QUFFMUIsU0FBSyxjQUFjLEtBQUssbUJBQW1CO0FBQUE7QUFBQSxFQUUvQyxhQUFhLE1BQWMsUUFBc0I7QUFDN0MsVUFBTSxnQkFBNkM7QUFDbkQsV0FBTyxlQUFlLENBQUMsWUFBWTtBQUMvQixlQUFTLElBQUksR0FBRyxJQUFJLEtBQUssUUFBUSxLQUFLO0FBQ2xDLFlBQUksUUFBUSxPQUFPLFFBQVEsS0FBSyxDQUFDLE1BQU0sRUFBRSxPQUFPO0FBQ2hELFlBQUksT0FBTztBQUNQLGdCQUFNLFFBQVEsT0FBTyxRQUFRLFFBQVE7QUFDckMsY0FBSSxDQUFDLGNBQWMsUUFBUTtBQUN2QiwwQkFBYyxTQUFTLFdBQ25CO0FBQUE7QUFHUixjQUFJLFVBQVUsY0FBYztBQUM1QixrQkFBUSxZQUFZO0FBQ3BCLGtCQUFRLFdBQVcsS0FBSyxVQUFVLE1BQU0sSUFBSSxNQUFNO0FBRWxELGVBQUssTUFBTSxLQUFLLE1BQU0sS0FBSztBQUMzQjtBQUFBO0FBR0osZ0JBQVEsV0FBVyxLQUFLO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFJcEMsY0FBYyxTQUFxQjtBQUMvQixTQUFLLGtCQUFrQjtBQUN2QixRQUFJLFFBQVEsUUFBUTtBQUNoQixZQUFNLFVBQXVDO0FBQzdDLGlCQUFXLFlBQVksU0FBUztBQUM1QixZQUFJLENBQUUsVUFBUyxPQUFPLFVBQVU7QUFDNUIsa0JBQVEsU0FBUyxPQUFPLEtBQUssa0JBQWtCO0FBRS9DLGNBQUksd0JBQVEsUUFBUSxTQUFTLE1BQ3hCLGFBQ0EsUUFBUSxTQUFTO0FBQUE7QUFHMUIsY0FBTSxVQUFVLEtBQUsscUJBQXFCO0FBRTFDLGdCQUFRLFNBQVMsS0FBSyxPQUFPLFFBQVE7QUFBQTtBQUFBLFdBS3RDO0FBQ0gsV0FBSyxrQkFBa0IsUUFBUTtBQUFBO0FBQUE7QUFBQSxFQUl2QyxXQUFXLFFBQWtCO0FBQ3pCLFNBQUssT0FBTyxTQUFTO0FBQ3JCLFVBQU0sTUFDRixLQUFLLElBQUksUUFBUSxZQUFZLEtBQUssQ0FBQyxNQUFNLEVBQUUsTUFBTSxPQUFPLFFBQ3hELEtBQUssSUFBSSxRQUFRLFdBQVcsS0FBSyxDQUFDLE1BQU0sRUFBRSxNQUFNLE9BQU87QUFDM0QsUUFBSSxDQUFDLEtBQUs7QUFDTixVQUFJLHVCQUFPO0FBQ1g7QUFBQTtBQUdKLFNBQUssSUFBSSxRQUFRLFlBQVksSUFBSTtBQUNqQyxTQUFLLElBQUksT0FBTyxTQUFTLEtBQUs7QUFDOUIsU0FBSztBQUVMLFFBQUk7QUFDQSxZQUFNLFFBQ0YsSUFBSSxZQUFZLGlCQUFpQjtBQUNyQyxZQUFNLEtBQUssTUFBTSxLQUFLLE9BQU8sS0FDekIsQ0FBQyxNQUFNLEVBQUUsZUFBZSxPQUFPO0FBRW5DLFVBQUksQ0FBQztBQUFJO0FBRVQsWUFBTSxVQUFVLEdBQUcsUUFBUTtBQUMzQixVQUFJLENBQUM7QUFBUztBQUVkLFVBQUksSUFBSSxNQUFNLDJCQUEyQjtBQUNyQyxZQUFJLFlBQVksUUFBUSxRQUFRO0FBQ2hDLFlBQUksV0FBVyxXQUFXO0FBRTFCLGVBQ0ksWUFBWSxRQUNaLFNBQVMsU0FBUyxtQkFDbEIsU0FBUyxTQUFTLDJCQUNwQjtBQUNFLG1CQUFTLFlBQVk7QUFDckIsc0JBQVksVUFBVSxlQUFlLFFBQ2pDO0FBRUoscUJBQVcsV0FBVztBQUFBO0FBQUE7QUFJOUIsVUFBSSxVQUFVLFFBQVEsUUFBUTtBQUM5QixhQUFPLFNBQVM7QUFDWixnQkFBUSxRQUFRLFFBQVE7QUFDeEIsa0JBQVUsUUFBUSxlQUFlLFFBQVE7QUFBQTtBQUc3QyxjQUFRLGVBQWU7QUFFdkIsY0FBUSxTQUFTO0FBQ2pCLGFBQU8sV0FBVyxNQUFNLFFBQVEsWUFBWSxnQkFBZ0I7QUFBQSxhQUN2RCxHQUFQO0FBQ0UsY0FBUSxNQUFNO0FBQUE7QUFBQTtBQUFBLEVBSXRCLG1CQUFtQixPQUFlO0FBQzlCLFVBQU0sVUFBc0IsSUFDeEIsVUFBc0I7QUFDMUIsZUFBVyxZQUFZLEtBQUssV0FBVztBQUNuQyxVQUFJLFNBQ0EseUNBQW9CLE9BQU8sU0FBUyxTQUNwQyx5Q0FBb0IsT0FBTyxTQUFTO0FBQ3hDLFVBQUksUUFBUTtBQUNSLFlBQUksU0FBUyxPQUFPLFdBQVc7QUFDM0Isa0JBQVEsS0FBSztBQUFBLGVBQ1Y7QUFDSCxrQkFBUSxLQUFLO0FBQUE7QUFBQTtBQUFBO0FBSXpCLFNBQUssVUFBVSxDQUFDLEdBQUcsU0FBUyxHQUFHO0FBQy9CLFdBQU8sS0FBSztBQUFBO0FBQUEsRUFHaEIsV0FBVztBQUNQLFNBQUssaUJBQWlCO0FBRXRCLFNBQUssa0JBQWtCO0FBQ3ZCLFNBQUs7QUFDTCxRQUFJLEtBQUssa0JBQWtCLHlCQUFTO0FBQ2hDLFdBQUssSUFBSSxRQUFRLFlBQVksS0FBSyxJQUFJLFFBQVE7QUFBQTtBQUFBOyIsCiAgIm5hbWVzIjogW10KfQo=
