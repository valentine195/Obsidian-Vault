/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};

// src/main.ts
__export(exports, {
  default: () => SettingsSearch
});
var import_obsidian = __toModule(require("obsidian"));

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/main.ts
var SettingsSearch = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "settingsSearchEl", createDiv("settings-search-container vertical-tab-header-group"));
    __publicField(this, "settingsResultsContainerEl", createDiv("settings-search-results-container vertical-tab-content"));
    __publicField(this, "settingsNavItemContainer", this.settingsSearchEl.createDiv("vertical-tab-header-group-items").createDiv("vertical-tab-nav-item settings-search-input"));
    __publicField(this, "settingsResultsEl");
    __publicField(this, "search");
    __publicField(this, "locale");
    __publicField(this, "resources", []);
    __publicField(this, "results", []);
    __publicField(this, "tabIndex", 0);
    __publicField(this, "pluginTabIndex", 0);
    __publicField(this, "settingCache", new Map());
    __publicField(this, "searchAppended", false);
    __publicField(this, "activeIndex", -1);
    __publicField(this, "activeSetting");
    __publicField(this, "scope", new import_obsidian.Scope(this.app.scope));
    __publicField(this, "mobileContainers", []);
  }
  async onload() {
    (window["SettingsSearch"] = {
      addResource: this.addResource.bind(this)
    }) && this.register(() => delete window["SettingsSearch"]);
    this.app.workspace.onLayoutReady(async () => {
      this.settingsResultsContainerEl.createEl("h3", {
        text: "Settings Search Results"
      });
      this.settingsResultsEl = this.settingsResultsContainerEl.createDiv("settings-search-results");
      this.buildScope();
      this.buildSearch();
      this.buildResources();
      this.buildPluginResources();
      this.patchSettings();
    });
  }
  buildResources() {
    const tab = this.app.setting.settingTabs[this.tabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.tabIndex++;
      setTimeout(() => this.buildResources());
    }
  }
  buildPluginResources() {
    const tab = this.app.setting.pluginTabs[this.pluginTabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.pluginTabIndex++;
      setTimeout(() => this.buildPluginResources());
    }
  }
  get manifests() {
    return Object.values(this.app.plugins.manifests);
  }
  addResourceToCache(resource) {
    if (!resource || !resource.text || !resource.name || !resource.tab) {
      return new Error("A valid resource must be provided.");
    }
    let name;
    if (resource.external) {
      name = createFragment((el) => {
        (0, import_obsidian.setIcon)(el.createSpan({
          attr: {
            "aria-label": "This setting was added by another plugin."
          }
        }), "info");
        el.createSpan({ text: resource.name });
      });
    } else {
      name = resource.name;
    }
    const setting = new import_obsidian.Setting(createDiv()).setName(name).setDesc(createFragment((e) => e.createDiv().innerHTML = resource.desc ?? ""));
    if (resource.external) {
      setting.settingEl.addClass("set-externally");
    }
    if (resource.tab == "community-plugins") {
      let plugin = this.manifests.find((p) => p.name == resource.text);
      if (plugin && this.app.plugins.getPlugin(plugin.id)?._loaded && this.app.setting.pluginTabs.find((t) => t.id == plugin.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.id);
          });
        });
      }
    }
    if (resource.tab == "plugins") {
      const plugins = Object.values(this.app.internalPlugins.plugins);
      const plugin = plugins.find((p) => p._loaded && p.instance.name == resource.text);
      if (plugin && this.app.setting.pluginTabs.find((t) => t.id == plugin.instance.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.instance.id);
          });
        });
      }
    }
    setting.addExtraButton((b) => {
      b.setIcon("forward-arrow").onClick(() => {
        this.showResult(resource);
      });
    });
    this.settingCache.set(resource, setting);
  }
  getResourceFromCache(resource) {
    if (!this.settingCache.has(resource)) {
      this.addResourceToCache(resource);
    }
    return this.settingCache.get(resource);
  }
  removeResourcesFromCache(resources) {
    for (const resource of resources) {
      this.settingCache.delete(resource);
    }
  }
  addResource(resource) {
    resource.external = true;
    this.resources.push(resource);
    this.addResourceToCache(resource);
  }
  async getTabResources(tab) {
    await tab.display();
    const settings = tab.containerEl.querySelectorAll(".setting-item:not(.setting-item-header)");
    for (const el of Array.from(settings)) {
      const text = el.querySelector(".setting-item-name")?.textContent;
      if (!text)
        continue;
      const desc = el.querySelector(".setting-item-description")?.innerHTML ?? "";
      const resource = {
        tab: tab.id,
        name: tab.name,
        text,
        desc
      };
      this.resources.push(resource);
      this.addResourceToCache(resource);
    }
    if (this.app.setting.activeTab?.id == tab.id)
      return;
    tab.containerEl.detach();
    tab.hide();
  }
  patchSettings() {
    const self = this;
    this.register(around(this.app.setting, {
      onOpen: function(next) {
        return function() {
          next.apply(this);
          if (!import_obsidian.Platform.isMobile)
            self.search.inputEl.focus();
          return next;
        };
      }
    }));
    this.register(around(this.app.setting, {
      addSettingTab: function(next) {
        return function(tab) {
          self.getTabResources(tab);
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      removeSettingTab: function(next) {
        return function(tab) {
          if (this.isPluginSettingTab(tab)) {
            const removing = self.resources.filter((t) => t.tab == tab.id);
            self.resources = self.resources.filter((t) => t.tab != tab.id);
            self.removeResourcesFromCache(removing);
          }
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      openTab: function(next) {
        return function(tab) {
          self.searchAppended = false;
          self.app.keymap.popScope(self.scope);
          return next.call(this, tab);
        };
      },
      openTabById: function(next) {
        return function(tab) {
          self.searchAppended = false;
          self.app.keymap.popScope(self.scope);
          return next.call(this, tab);
        };
      },
      onClose: function(next) {
        return function() {
          if (import_obsidian.Platform.isMobile) {
            self.detach();
          }
          return next.call(this);
        };
      }
    }));
  }
  buildSearch() {
    const tempSetting = new import_obsidian.Setting(createDiv()).addSearch((s) => {
      this.search = s;
    });
    this.settingsNavItemContainer.append(tempSetting.controlEl);
    tempSetting.settingEl.detach();
    this.search.onChange((v) => {
      this.onChange(v);
    });
    this.search.setPlaceholder("Search settings...");
    this.app.setting.tabHeadersEl.prepend(this.settingsSearchEl);
  }
  buildScope() {
    this.scope.register([], "ArrowDown", () => {
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
      }
      this.activeIndex = ((this.activeIndex + 1) % this.results.length + this.results.length) % this.results.length;
      this.centerActiveSetting();
    });
    this.scope.register([], "ArrowUp", () => {
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
      }
      this.activeIndex = ((this.activeIndex - 1) % this.results.length + this.results.length) % this.results.length;
      this.centerActiveSetting();
    });
    this.scope.register([], "Enter", () => {
      if (this.activeSetting) {
        this.showResult(this.results[this.activeIndex]);
      }
    });
  }
  centerActiveSetting() {
    const result = this.results[this.activeIndex];
    this.activeSetting = this.getResourceFromCache(result);
    this.activeSetting.settingEl.addClass("active");
    this.activeSetting.settingEl.scrollIntoView({
      behavior: "auto",
      block: "nearest"
    });
  }
  detachFromMobile() {
    if (import_obsidian.Platform.isMobile) {
      this.settingsResultsContainerEl.detach();
      for (const header of this.mobileContainers) {
        this.app.setting.tabHeadersEl.append(header);
      }
      this.search.setValue("");
    }
  }
  detachFromDesktop() {
    if (import_obsidian.Platform.isDesktop) {
      this.app.setting.openTabById(this.app.setting.lastTabId);
    }
  }
  detach() {
    this.detachFromDesktop();
    this.detachFromMobile();
    this.searchAppended = false;
  }
  onChange(v) {
    if (!v) {
      this.detach();
      this.app.keymap.popScope(this.scope);
      return;
    }
    if (!this.searchAppended) {
      this.activeIndex = -1;
      this.app.keymap.popScope(this.scope);
      this.app.keymap.pushScope(this.scope);
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
        this.activeSetting = null;
      }
      if (!import_obsidian.Platform.isMobile) {
        this.app.setting.activeTab.navEl.removeClass("is-active");
        this.app.setting.tabContentContainer.empty();
        this.app.setting.tabContentContainer.append(this.settingsResultsContainerEl);
      } else {
        const headers = this.app.setting.tabHeadersEl.querySelectorAll(".vertical-tab-header-group:not(.settings-search-container)");
        for (const header of Array.from(headers)) {
          this.mobileContainers.push(header);
          header.detach();
        }
        this.app.setting.tabHeadersEl.append(this.settingsResultsContainerEl);
      }
      this.searchAppended = true;
    }
    this.appendResults(this.performFuzzySearch(v));
  }
  getMatchText(text, result) {
    const matchElements = {};
    return createFragment((content) => {
      for (let i = 0; i < text.length; i++) {
        let match = result.matches.find((m) => m[0] === i);
        if (match) {
          const index = result.matches.indexOf(match);
          if (!matchElements[index]) {
            matchElements[index] = createSpan("suggestion-highlight");
          }
          let element = matchElements[index];
          content.appendChild(element);
          element.appendText(text.substring(match[0], match[1]));
          i += match[1] - match[0] - 1;
          continue;
        }
        content.appendText(text[i]);
      }
    });
  }
  appendResults(results) {
    this.settingsResultsEl.empty();
    if (results.length) {
      const headers = {};
      for (const resource of results) {
        if (!(resource.tab in headers)) {
          headers[resource.tab] = this.settingsResultsEl.createDiv();
          new import_obsidian.Setting(headers[resource.tab]).setHeading().setName(resource.name);
        }
        const setting = this.getResourceFromCache(resource);
        headers[resource.tab].append(setting.settingEl);
      }
    } else {
      this.settingsResultsEl.setText("No results found :(");
    }
  }
  showResult(result) {
    this.search.setValue("");
    const tab = this.app.setting.settingTabs.find((t) => t.id == result.tab) ?? this.app.setting.pluginTabs.find((t) => t.id == result.tab);
    if (!tab) {
      new import_obsidian.Notice("There was an issue opening the setting tab.");
      return;
    }
    this.app.setting.openTabById(tab.id);
    this.app.keymap.popScope(this.scope);
    this.detach();
    try {
      const names = tab.containerEl.querySelectorAll(".setting-item-name");
      const el = Array.from(names).find((n) => n.textContent == result.text);
      if (!el)
        return;
      const setting = el.closest(".setting-item");
      if (!setting)
        return;
      if (tab.id == "obsidian-style-settings") {
        let collapsed = setting.closest(".style-settings-container");
        let previous = collapsed?.previousElementSibling;
        while (previous != null && previous.hasClass("is-collapsed") && previous.hasClass("style-settings-heading")) {
          previous.removeClass("is-collapsed");
          collapsed = collapsed.parentElement?.closest(".style-settings-container");
          previous = collapsed?.previousElementSibling;
        }
      }
      let details = setting.closest("details");
      while (details) {
        details.setAttr("open", "open");
        details = details.parentElement?.closest("details");
      }
      setting.scrollIntoView(true);
      setting.addClass("is-flashing");
      window.setTimeout(() => setting.removeClass("is-flashing"), 3e3);
    } catch (e) {
      console.error(e);
    }
  }
  performFuzzySearch(input) {
    const results = [], hotkeys = [];
    for (const resource of this.resources) {
      let result = (0, import_obsidian.prepareSimpleSearch)(input)(resource.text) ?? (0, import_obsidian.prepareSimpleSearch)(input)(resource.desc);
      if (result) {
        if (resource.tab == "hotkeys") {
          hotkeys.push(resource);
        } else {
          results.push(resource);
        }
      }
    }
    this.results = [...results, ...hotkeys];
    return this.results;
  }
  onunload() {
    this.settingsSearchEl.detach();
    this.settingsResultsEl.detach();
    this.detach();
    if (this.searchAppended && import_obsidian.Platform.isDesktop)
      this.app.setting.openTabById(this.app.setting.lastTabId);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vR2l0SHViL29ic2lkaWFuLXNldHRpbmdzLXNlYXJjaC9zcmMvbWFpbi50cyIsICIuLi8uLi8uLi8uLi9HaXRIdWIvb2JzaWRpYW4tc2V0dGluZ3Mtc2VhcmNoL25vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcbiAgICBQbHVnaW4sXG4gICAgU2VhcmNoQ29tcG9uZW50LFxuICAgIFNldHRpbmcsXG4gICAgU2VhcmNoUmVzdWx0LFxuICAgIE5vdGljZSxcbiAgICBwcmVwYXJlU2ltcGxlU2VhcmNoLFxuICAgIFNldHRpbmdUYWIsXG4gICAgU2NvcGUsXG4gICAgUGxhdGZvcm0sXG4gICAgc2V0SWNvblxufSBmcm9tIFwib2JzaWRpYW5cIjtcblxuaW1wb3J0IHsgYXJvdW5kIH0gZnJvbSBcIm1vbmtleS1hcm91bmRcIjtcblxuZGVjbGFyZSBtb2R1bGUgXCJvYnNpZGlhblwiIHtcbiAgICBpbnRlcmZhY2UgQXBwIHtcbiAgICAgICAgaW50ZXJuYWxQbHVnaW5zOiB7XG4gICAgICAgICAgICBwbHVnaW5zOiBSZWNvcmQ8XG4gICAgICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgICAgIHsgX2xvYWRlZDogYm9vbGVhbjsgaW5zdGFuY2U6IHsgbmFtZTogc3RyaW5nOyBpZDogc3RyaW5nIH0gfVxuICAgICAgICAgICAgPjtcbiAgICAgICAgfTtcbiAgICAgICAgcGx1Z2luczoge1xuICAgICAgICAgICAgbWFuaWZlc3RzOiBSZWNvcmQ8c3RyaW5nLCBQbHVnaW5NYW5pZmVzdD47XG4gICAgICAgICAgICBwbHVnaW5zOiBSZWNvcmQ8c3RyaW5nLCBQbHVnaW4+O1xuICAgICAgICAgICAgZ2V0UGx1Z2luKGlkOiBzdHJpbmcpOiBQbHVnaW47XG4gICAgICAgIH07XG4gICAgICAgIHNldHRpbmc6IHtcbiAgICAgICAgICAgIG9uT3BlbigpOiB2b2lkO1xuICAgICAgICAgICAgb25DbG9zZSgpOiB2b2lkO1xuXG4gICAgICAgICAgICBvcGVuVGFiQnlJZChpZDogc3RyaW5nKTogdm9pZDtcbiAgICAgICAgICAgIG9wZW5UYWIodGFiOiBTZXR0aW5nVGFiKTogdm9pZDtcblxuICAgICAgICAgICAgaXNQbHVnaW5TZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IGJvb2xlYW47XG4gICAgICAgICAgICBhZGRTZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IHZvaWQ7XG4gICAgICAgICAgICByZW1vdmVTZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IHZvaWQ7XG5cbiAgICAgICAgICAgIGFjdGl2ZVRhYjogU2V0dGluZ1RhYjtcbiAgICAgICAgICAgIGxhc3RUYWJJZDogc3RyaW5nO1xuXG4gICAgICAgICAgICBwbHVnaW5UYWJzOiBQbHVnaW5TZXR0aW5nVGFiW107XG4gICAgICAgICAgICBzZXR0aW5nVGFiczogU2V0dGluZ1RhYltdO1xuXG4gICAgICAgICAgICB0YWJDb250ZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIHRhYkhlYWRlcnNFbDogSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGludGVyZmFjZSBQbHVnaW4ge1xuICAgICAgICBfbG9hZGVkOiBib29sZWFuO1xuICAgIH1cbiAgICBpbnRlcmZhY2UgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICB9XG4gICAgaW50ZXJmYWNlIFNldHRpbmdUYWIge1xuICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIG5hdkVsOiBIVE1MRWxlbWVudDtcbiAgICB9XG59XG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgICAgIFNldHRpbmdzU2VhcmNoPzoge1xuICAgICAgICAgICAgYWRkUmVzb3VyY2U6IFNldHRpbmdzU2VhcmNoW1wiYWRkUmVzb3VyY2VcIl07XG4gICAgICAgIH07XG4gICAgfVxufVxuXG5pbnRlcmZhY2UgUmVzb3VyY2Uge1xuICAgIHRhYjogc3RyaW5nO1xuICAgIC8vdGFiIG5hbWVcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIGRlc2M6IHN0cmluZztcbiAgICBleHRlcm5hbD86IGJvb2xlYW47XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXR0aW5nc1NlYXJjaCBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3NTZWFyY2hFbDogSFRNTERpdkVsZW1lbnQgPSBjcmVhdGVEaXYoXG4gICAgICAgIFwic2V0dGluZ3Mtc2VhcmNoLWNvbnRhaW5lciB2ZXJ0aWNhbC10YWItaGVhZGVyLWdyb3VwXCJcbiAgICApO1xuICAgIHNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsID0gY3JlYXRlRGl2KFxuICAgICAgICBcInNldHRpbmdzLXNlYXJjaC1yZXN1bHRzLWNvbnRhaW5lciB2ZXJ0aWNhbC10YWItY29udGVudFwiXG4gICAgKTtcbiAgICBzZXR0aW5nc05hdkl0ZW1Db250YWluZXIgPSB0aGlzLnNldHRpbmdzU2VhcmNoRWxcbiAgICAgICAgLmNyZWF0ZURpdihcInZlcnRpY2FsLXRhYi1oZWFkZXItZ3JvdXAtaXRlbXNcIilcbiAgICAgICAgLmNyZWF0ZURpdihcInZlcnRpY2FsLXRhYi1uYXYtaXRlbSBzZXR0aW5ncy1zZWFyY2gtaW5wdXRcIik7XG4gICAgc2V0dGluZ3NSZXN1bHRzRWw6IEhUTUxEaXZFbGVtZW50O1xuICAgIHNlYXJjaDogU2VhcmNoQ29tcG9uZW50O1xuICAgIGxvY2FsZTogc3RyaW5nO1xuXG4gICAgcmVzb3VyY2VzOiBSZXNvdXJjZVtdID0gW107XG4gICAgcmVzdWx0czogUmVzb3VyY2VbXSA9IFtdO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICAod2luZG93W1wiU2V0dGluZ3NTZWFyY2hcIl0gPSB7XG4gICAgICAgICAgICBhZGRSZXNvdXJjZTogdGhpcy5hZGRSZXNvdXJjZS5iaW5kKHRoaXMpXG4gICAgICAgIH0pICYmIHRoaXMucmVnaXN0ZXIoKCkgPT4gZGVsZXRlIHdpbmRvd1tcIlNldHRpbmdzU2VhcmNoXCJdKTtcblxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiU2V0dGluZ3MgU2VhcmNoIFJlc3VsdHNcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0VsID0gdGhpcy5zZXR0aW5nc1Jlc3VsdHNDb250YWluZXJFbC5jcmVhdGVEaXYoXG4gICAgICAgICAgICAgICAgXCJzZXR0aW5ncy1zZWFyY2gtcmVzdWx0c1wiXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLmJ1aWxkU2NvcGUoKTtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRTZWFyY2goKTtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRSZXNvdXJjZXMoKTtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRQbHVnaW5SZXNvdXJjZXMoKTtcbiAgICAgICAgICAgIHRoaXMucGF0Y2hTZXR0aW5ncygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgdGFiSW5kZXggPSAwO1xuICAgIHBsdWdpblRhYkluZGV4ID0gMDtcbiAgICBidWlsZFJlc291cmNlcygpIHtcbiAgICAgICAgY29uc3QgdGFiID0gdGhpcy5hcHAuc2V0dGluZy5zZXR0aW5nVGFic1t0aGlzLnRhYkluZGV4XTtcbiAgICAgICAgaWYgKHRhYikge1xuICAgICAgICAgICAgdGhpcy5nZXRUYWJSZXNvdXJjZXModGFiKTtcbiAgICAgICAgICAgIHRoaXMudGFiSW5kZXgrKztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5idWlsZFJlc291cmNlcygpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBidWlsZFBsdWdpblJlc291cmNlcygpIHtcbiAgICAgICAgY29uc3QgdGFiID0gdGhpcy5hcHAuc2V0dGluZy5wbHVnaW5UYWJzW3RoaXMucGx1Z2luVGFiSW5kZXhdO1xuICAgICAgICBpZiAodGFiKSB7XG4gICAgICAgICAgICB0aGlzLmdldFRhYlJlc291cmNlcyh0YWIpO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW5UYWJJbmRleCsrO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmJ1aWxkUGx1Z2luUmVzb3VyY2VzKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBtYW5pZmVzdHMoKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuYXBwLnBsdWdpbnMubWFuaWZlc3RzKTtcbiAgICB9XG4gICAgc2V0dGluZ0NhY2hlOiBNYXA8UmVzb3VyY2UsIFNldHRpbmc+ID0gbmV3IE1hcCgpO1xuICAgIHB1YmxpYyBhZGRSZXNvdXJjZVRvQ2FjaGUocmVzb3VyY2U6IFJlc291cmNlKSB7XG4gICAgICAgIGlmICghcmVzb3VyY2UgfHwgIXJlc291cmNlLnRleHQgfHwgIXJlc291cmNlLm5hbWUgfHwgIXJlc291cmNlLnRhYikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcihcIkEgdmFsaWQgcmVzb3VyY2UgbXVzdCBiZSBwcm92aWRlZC5cIik7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbmFtZTogRG9jdW1lbnRGcmFnbWVudCB8IHN0cmluZztcbiAgICAgICAgaWYgKHJlc291cmNlLmV4dGVybmFsKSB7XG4gICAgICAgICAgICBuYW1lID0gY3JlYXRlRnJhZ21lbnQoKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0SWNvbihcbiAgICAgICAgICAgICAgICAgICAgZWwuY3JlYXRlU3Bhbih7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcmlhLWxhYmVsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVGhpcyBzZXR0aW5nIHdhcyBhZGRlZCBieSBhbm90aGVyIHBsdWdpbi5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgXCJpbmZvXCJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGVsLmNyZWF0ZVNwYW4oeyB0ZXh0OiByZXNvdXJjZS5uYW1lIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuYW1lID0gcmVzb3VyY2UubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY3JlYXRlRGl2KCkpXG4gICAgICAgICAgICAuc2V0TmFtZShuYW1lKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgY3JlYXRlRnJhZ21lbnQoXG4gICAgICAgICAgICAgICAgICAgIChlKSA9PiAoZS5jcmVhdGVEaXYoKS5pbm5lckhUTUwgPSByZXNvdXJjZS5kZXNjID8/IFwiXCIpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgaWYgKHJlc291cmNlLmV4dGVybmFsKSB7XG5cbiAgICAgICAgICAgIHNldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKFwic2V0LWV4dGVybmFsbHlcIilcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzb3VyY2UudGFiID09IFwiY29tbXVuaXR5LXBsdWdpbnNcIikge1xuICAgICAgICAgICAgbGV0IHBsdWdpbiA9IHRoaXMubWFuaWZlc3RzLmZpbmQoKHApID0+IHAubmFtZSA9PSByZXNvdXJjZS50ZXh0KTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBwbHVnaW4gJiZcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5wbHVnaW5zLmdldFBsdWdpbihwbHVnaW4uaWQpPy5fbG9hZGVkICYmXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5wbHVnaW5UYWJzLmZpbmQoKHQpID0+IHQuaWQgPT0gcGx1Z2luLmlkKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBiLnNldFRvb2x0aXAoYE9wZW4gJHtyZXNvdXJjZS50ZXh0fSBTZXR0aW5nc2ApLm9uQ2xpY2soXG4gICAgICAgICAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZChwbHVnaW4uaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyZXNvdXJjZS50YWIgPT0gXCJwbHVnaW5zXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbnMgPSBPYmplY3QudmFsdWVzKHRoaXMuYXBwLmludGVybmFsUGx1Z2lucy5wbHVnaW5zKTtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IHBsdWdpbnMuZmluZChcbiAgICAgICAgICAgICAgICAocCkgPT4gcC5fbG9hZGVkICYmIHAuaW5zdGFuY2UubmFtZSA9PSByZXNvdXJjZS50ZXh0XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgcGx1Z2luICYmXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5wbHVnaW5UYWJzLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LmlkID09IHBsdWdpbi5pbnN0YW5jZS5pZFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHNldHRpbmcuYWRkRXh0cmFCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYi5zZXRUb29sdGlwKGBPcGVuICR7cmVzb3VyY2UudGV4dH0gU2V0dGluZ3NgKS5vbkNsaWNrKFxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQocGx1Z2luLmluc3RhbmNlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXR0aW5nLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJmb3J3YXJkLWFycm93XCIpLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1Jlc3VsdChyZXNvdXJjZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0dGluZ0NhY2hlLnNldChyZXNvdXJjZSwgc2V0dGluZyk7XG4gICAgfVxuICAgIGdldFJlc291cmNlRnJvbUNhY2hlKHJlc291cmNlOiBSZXNvdXJjZSkge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ0NhY2hlLmhhcyhyZXNvdXJjZSkpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkUmVzb3VyY2VUb0NhY2hlKHJlc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5nQ2FjaGUuZ2V0KHJlc291cmNlKTtcbiAgICB9XG4gICAgcmVtb3ZlUmVzb3VyY2VzRnJvbUNhY2hlKHJlc291cmNlczogUmVzb3VyY2VbXSkge1xuICAgICAgICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHJlc291cmNlcykge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nQ2FjaGUuZGVsZXRlKHJlc291cmNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhZGRSZXNvdXJjZShyZXNvdXJjZTogUmVzb3VyY2UpIHtcbiAgICAgICAgcmVzb3VyY2UuZXh0ZXJuYWwgPSB0cnVlO1xuICAgICAgICB0aGlzLnJlc291cmNlcy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgdGhpcy5hZGRSZXNvdXJjZVRvQ2FjaGUocmVzb3VyY2UpO1xuICAgIH1cbiAgICBhc3luYyBnZXRUYWJSZXNvdXJjZXModGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgICAgIGF3YWl0IHRhYi5kaXNwbGF5KCk7XG5cbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0YWIuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbDxIVE1MRGl2RWxlbWVudD4oXG4gICAgICAgICAgICBcIi5zZXR0aW5nLWl0ZW06bm90KC5zZXR0aW5nLWl0ZW0taGVhZGVyKVwiXG4gICAgICAgICk7XG4gICAgICAgIGZvciAoY29uc3QgZWwgb2YgQXJyYXkuZnJvbShzZXR0aW5ncykpIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPVxuICAgICAgICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3I8SFRNTERpdkVsZW1lbnQ+KFxuICAgICAgICAgICAgICAgICAgICBcIi5zZXR0aW5nLWl0ZW0tbmFtZVwiXG4gICAgICAgICAgICAgICAgKT8udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICBpZiAoIXRleHQpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBjb25zdCBkZXNjID1cbiAgICAgICAgICAgICAgICBlbC5xdWVyeVNlbGVjdG9yPEhUTUxEaXZFbGVtZW50PihcIi5zZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIilcbiAgICAgICAgICAgICAgICAgICAgPy5pbm5lckhUTUwgPz8gXCJcIjtcblxuICAgICAgICAgICAgY29uc3QgcmVzb3VyY2UgPSB7XG4gICAgICAgICAgICAgICAgdGFiOiB0YWIuaWQsXG4gICAgICAgICAgICAgICAgbmFtZTogdGFiLm5hbWUsXG4gICAgICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgICAgICBkZXNjXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZXMucHVzaChyZXNvdXJjZSk7XG4gICAgICAgICAgICB0aGlzLmFkZFJlc291cmNlVG9DYWNoZShyZXNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYXBwLnNldHRpbmcuYWN0aXZlVGFiPy5pZCA9PSB0YWIuaWQpIHJldHVybjtcbiAgICAgICAgdGFiLmNvbnRhaW5lckVsLmRldGFjaCgpO1xuICAgICAgICB0YWIuaGlkZSgpO1xuICAgIH1cblxuICAgIHBhdGNoU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXG4gICAgICAgICAgICBhcm91bmQodGhpcy5hcHAuc2V0dGluZywge1xuICAgICAgICAgICAgICAgIG9uT3BlbjogZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQuYXBwbHkodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSBzZWxmLnNlYXJjaC5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vUGF0Y2ggYWRkU2V0dGluZ1RhYiB0byBjYXB0dXJlIGNoYW5nZXMgdG8gcGx1Z2luIHNldHRpbmdzLlxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcbiAgICAgICAgICAgICAgICBhZGRTZXR0aW5nVGFiOiBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogU2V0dGluZ1RhYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5nZXRUYWJSZXNvdXJjZXModGFiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgdGFiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vUGF0Y2ggcmVtb3ZlU2V0dGluZ1RhYiB0byBjYXB0dXJlIGNoYW5nZXMgdG8gcGx1Z2luIHNldHRpbmdzLlxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcbiAgICAgICAgICAgICAgICByZW1vdmVTZXR0aW5nVGFiOiBmdW5jdGlvbiAobmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogU2V0dGluZ1RhYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbHVnaW5TZXR0aW5nVGFiKHRhYikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZW1vdmluZyA9IHNlbGYucmVzb3VyY2VzLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQpID0+IHQudGFiID09IHRhYi5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZXNvdXJjZXMgPSBzZWxmLnJlc291cmNlcy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LnRhYiAhPSB0YWIuaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucmVtb3ZlUmVzb3VyY2VzRnJvbUNhY2hlKHJlbW92aW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgdGFiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXG4gICAgICAgICAgICBhcm91bmQodGhpcy5hcHAuc2V0dGluZywge1xuICAgICAgICAgICAgICAgIG9wZW5UYWI6IGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodGFiOiBTZXR0aW5nVGFiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlYXJjaEFwcGVuZGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFwcC5rZXltYXAucG9wU2NvcGUoc2VsZi5zY29wZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMsIHRhYik7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvcGVuVGFiQnlJZDogZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YWI6IHN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWFyY2hBcHBlbmRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcHAua2V5bWFwLnBvcFNjb3BlKHNlbGYuc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FsbCh0aGlzLCB0YWIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25DbG9zZTogZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgYnVpbGRTZWFyY2goKSB7XG4gICAgICAgIGNvbnN0IHRlbXBTZXR0aW5nID0gbmV3IFNldHRpbmcoY3JlYXRlRGl2KCkpLmFkZFNlYXJjaCgocykgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSBzO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnNldHRpbmdzTmF2SXRlbUNvbnRhaW5lci5hcHBlbmQodGVtcFNldHRpbmcuY29udHJvbEVsKTtcblxuICAgICAgICB0ZW1wU2V0dGluZy5zZXR0aW5nRWwuZGV0YWNoKCk7XG5cbiAgICAgICAgdGhpcy5zZWFyY2gub25DaGFuZ2UoKHYpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2Uodik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNlYXJjaC5zZXRQbGFjZWhvbGRlcihcIlNlYXJjaCBzZXR0aW5ncy4uLlwiKTtcbiAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJIZWFkZXJzRWwucHJlcGVuZCh0aGlzLnNldHRpbmdzU2VhcmNoRWwpO1xuICAgIH1cblxuICAgIHNlYXJjaEFwcGVuZGVkID0gZmFsc2U7XG4gICAgYWN0aXZlSW5kZXggPSAtMTtcbiAgICBhY3RpdmVTZXR0aW5nOiBTZXR0aW5nO1xuICAgIHNjb3BlID0gbmV3IFNjb3BlKHRoaXMuYXBwLnNjb3BlKTtcbiAgICBidWlsZFNjb3BlKCkge1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkFycm93RG93blwiLCAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVTZXR0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nLnNldHRpbmdFbC5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPVxuICAgICAgICAgICAgICAgICgoKHRoaXMuYWN0aXZlSW5kZXggKyAxKSAlIHRoaXMucmVzdWx0cy5sZW5ndGgpICtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRzLmxlbmd0aCkgJVxuICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0cy5sZW5ndGg7XG5cbiAgICAgICAgICAgIHRoaXMuY2VudGVyQWN0aXZlU2V0dGluZygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJBcnJvd1VwXCIsICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVNldHRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcuc2V0dGluZ0VsLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9XG4gICAgICAgICAgICAgICAgKCgodGhpcy5hY3RpdmVJbmRleCAtIDEpICUgdGhpcy5yZXN1bHRzLmxlbmd0aCkgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoKSAlXG4gICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRzLmxlbmd0aDtcblxuICAgICAgICAgICAgdGhpcy5jZW50ZXJBY3RpdmVTZXR0aW5nKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVudGVyXCIsICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVNldHRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSZXN1bHQodGhpcy5yZXN1bHRzW3RoaXMuYWN0aXZlSW5kZXhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2VudGVyQWN0aXZlU2V0dGluZygpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHRzW3RoaXMuYWN0aXZlSW5kZXhdO1xuICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcgPSB0aGlzLmdldFJlc291cmNlRnJvbUNhY2hlKHJlc3VsdCk7XG4gICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG5cbiAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nLnNldHRpbmdFbC5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICBiZWhhdmlvcjogXCJhdXRvXCIsXG4gICAgICAgICAgICBibG9jazogXCJuZWFyZXN0XCJcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG1vYmlsZUNvbnRhaW5lcnM6IEhUTUxFbGVtZW50W10gPSBbXTtcbiAgICBkZXRhY2hGcm9tTW9iaWxlKCkge1xuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwuZGV0YWNoKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGhlYWRlciBvZiB0aGlzLm1vYmlsZUNvbnRhaW5lcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkhlYWRlcnNFbC5hcHBlbmQoaGVhZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VhcmNoLnNldFZhbHVlKFwiXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRldGFjaEZyb21EZXNrdG9wKCkge1xuICAgICAgICBpZiAoUGxhdGZvcm0uaXNEZXNrdG9wKSB7XG4gICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKHRoaXMuYXBwLnNldHRpbmcubGFzdFRhYklkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHRoaXMuZGV0YWNoRnJvbURlc2t0b3AoKTtcbiAgICAgICAgdGhpcy5kZXRhY2hGcm9tTW9iaWxlKCk7XG4gICAgICAgIHRoaXMuc2VhcmNoQXBwZW5kZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgb25DaGFuZ2Uodjogc3RyaW5nKSB7XG4gICAgICAgIGlmICghdikge1xuICAgICAgICAgICAgdGhpcy5kZXRhY2goKTtcbiAgICAgICAgICAgIHRoaXMuYXBwLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuc2VhcmNoQXBwZW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMTtcbiAgICAgICAgICAgIHRoaXMuYXBwLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcbiAgICAgICAgICAgIHRoaXMuYXBwLmtleW1hcC5wdXNoU2NvcGUodGhpcy5zY29wZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVTZXR0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nLnNldHRpbmdFbC5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcgPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5hY3RpdmVUYWIubmF2RWwucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJDb250ZW50Q29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJDb250ZW50Q29udGFpbmVyLmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNDb250YWluZXJFbFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkhlYWRlcnNFbC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxFbGVtZW50PihcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiLnZlcnRpY2FsLXRhYi1oZWFkZXItZ3JvdXA6bm90KC5zZXR0aW5ncy1zZWFyY2gtY29udGFpbmVyKVwiXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgQXJyYXkuZnJvbShoZWFkZXJzKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vYmlsZUNvbnRhaW5lcnMucHVzaChoZWFkZXIpO1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXIuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiSGVhZGVyc0VsLmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNDb250YWluZXJFbFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEFwcGVuZGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFwcGVuZFJlc3VsdHModGhpcy5wZXJmb3JtRnV6enlTZWFyY2godikpO1xuICAgIH1cbiAgICBnZXRNYXRjaFRleHQodGV4dDogc3RyaW5nLCByZXN1bHQ6IFNlYXJjaFJlc3VsdCkge1xuICAgICAgICBjb25zdCBtYXRjaEVsZW1lbnRzOiBSZWNvcmQ8bnVtYmVyLCBIVE1MRWxlbWVudD4gPSB7fTtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZyYWdtZW50KChjb250ZW50KSA9PiB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSByZXN1bHQubWF0Y2hlcy5maW5kKChtKSA9PiBtWzBdID09PSBpKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSByZXN1bHQubWF0Y2hlcy5pbmRleE9mKG1hdGNoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaEVsZW1lbnRzW2luZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hFbGVtZW50c1tpbmRleF0gPSBjcmVhdGVTcGFuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3VnZ2VzdGlvbi1oaWdobGlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgZWxlbWVudCA9IG1hdGNoRWxlbWVudHNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZFRleHQodGV4dC5zdWJzdHJpbmcobWF0Y2hbMF0sIG1hdGNoWzFdKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaSArPSBtYXRjaFsxXSAtIG1hdGNoWzBdIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29udGVudC5hcHBlbmRUZXh0KHRleHRbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXBwZW5kUmVzdWx0cyhyZXN1bHRzOiBSZXNvdXJjZVtdKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuZW1wdHkoKTtcbiAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBIVE1MRWxlbWVudD4gPSB7fTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzdWx0cykge1xuICAgICAgICAgICAgICAgIGlmICghKHJlc291cmNlLnRhYiBpbiBoZWFkZXJzKSkge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW3Jlc291cmNlLnRhYl0gPSB0aGlzLnNldHRpbmdzUmVzdWx0c0VsLmNyZWF0ZURpdigpO1xuXG4gICAgICAgICAgICAgICAgICAgIG5ldyBTZXR0aW5nKGhlYWRlcnNbcmVzb3VyY2UudGFiXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRIZWFkaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXROYW1lKHJlc291cmNlLm5hbWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHNldHRpbmcgPSB0aGlzLmdldFJlc291cmNlRnJvbUNhY2hlKHJlc291cmNlKTtcblxuICAgICAgICAgICAgICAgIGhlYWRlcnNbcmVzb3VyY2UudGFiXS5hcHBlbmQoc2V0dGluZy5zZXR0aW5nRWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogaWYgKFwiaG90a2V5c1wiIGluIGhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0VsLmFwcGVuZENoaWxkKGhlYWRlcnNbXCJob3RrZXlzXCJdKTtcbiAgICAgICAgICAgIH0gKi9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuc2V0VGV4dChcIk5vIHJlc3VsdHMgZm91bmQgOihcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzaG93UmVzdWx0KHJlc3VsdDogUmVzb3VyY2UpIHtcbiAgICAgICAgdGhpcy5zZWFyY2guc2V0VmFsdWUoXCJcIik7XG4gICAgICAgIGNvbnN0IHRhYiA9XG4gICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnNldHRpbmdUYWJzLmZpbmQoKHQpID0+IHQuaWQgPT0gcmVzdWx0LnRhYikgPz9cbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcucGx1Z2luVGFicy5maW5kKCh0KSA9PiB0LmlkID09IHJlc3VsdC50YWIpO1xuICAgICAgICBpZiAoIXRhYikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIlRoZXJlIHdhcyBhbiBpc3N1ZSBvcGVuaW5nIHRoZSBzZXR0aW5nIHRhYi5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKHRhYi5pZCk7XG4gICAgICAgIHRoaXMuYXBwLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcbiAgICAgICAgdGhpcy5kZXRhY2goKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbmFtZXMgPVxuICAgICAgICAgICAgICAgIHRhYi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNldHRpbmctaXRlbS1uYW1lXCIpO1xuICAgICAgICAgICAgY29uc3QgZWwgPSBBcnJheS5mcm9tKG5hbWVzKS5maW5kKFxuICAgICAgICAgICAgICAgIChuKSA9PiBuLnRleHRDb250ZW50ID09IHJlc3VsdC50ZXh0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKCFlbCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBjb25zdCBzZXR0aW5nID0gZWwuY2xvc2VzdChcIi5zZXR0aW5nLWl0ZW1cIik7XG4gICAgICAgICAgICBpZiAoIXNldHRpbmcpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKHRhYi5pZCA9PSBcIm9ic2lkaWFuLXN0eWxlLXNldHRpbmdzXCIpIHtcbiAgICAgICAgICAgICAgICBsZXQgY29sbGFwc2VkID0gc2V0dGluZy5jbG9zZXN0KFwiLnN0eWxlLXNldHRpbmdzLWNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgICAgICBsZXQgcHJldmlvdXMgPSBjb2xsYXBzZWQ/LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMuaGFzQ2xhc3MoXCJpcy1jb2xsYXBzZWRcIikgJiZcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMuaGFzQ2xhc3MoXCJzdHlsZS1zZXR0aW5ncy1oZWFkaW5nXCIpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLnJlbW92ZUNsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZWQgPSBjb2xsYXBzZWQucGFyZW50RWxlbWVudD8uY2xvc2VzdChcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiLnN0eWxlLXNldHRpbmdzLWNvbnRhaW5lclwiXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0gY29sbGFwc2VkPy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGRldGFpbHMgPSBzZXR0aW5nLmNsb3Nlc3QoXCJkZXRhaWxzXCIpO1xuICAgICAgICAgICAgd2hpbGUgKGRldGFpbHMpIHtcbiAgICAgICAgICAgICAgICBkZXRhaWxzLnNldEF0dHIoXCJvcGVuXCIsIFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICBkZXRhaWxzID0gZGV0YWlscy5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFwiZGV0YWlsc1wiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2V0dGluZy5zY3JvbGxJbnRvVmlldyh0cnVlKTtcblxuICAgICAgICAgICAgc2V0dGluZy5hZGRDbGFzcyhcImlzLWZsYXNoaW5nXCIpO1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gc2V0dGluZy5yZW1vdmVDbGFzcyhcImlzLWZsYXNoaW5nXCIpLCAzMDAwKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHBlcmZvcm1GdXp6eVNlYXJjaChpbnB1dDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdHM6IFJlc291cmNlW10gPSBbXSxcbiAgICAgICAgICAgIGhvdGtleXM6IFJlc291cmNlW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCByZXNvdXJjZSBvZiB0aGlzLnJlc291cmNlcykge1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9XG4gICAgICAgICAgICAgICAgcHJlcGFyZVNpbXBsZVNlYXJjaChpbnB1dCkocmVzb3VyY2UudGV4dCkgPz9cbiAgICAgICAgICAgICAgICBwcmVwYXJlU2ltcGxlU2VhcmNoKGlucHV0KShyZXNvdXJjZS5kZXNjKTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UudGFiID09IFwiaG90a2V5c1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGhvdGtleXMucHVzaChyZXNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXN1bHRzID0gWy4uLnJlc3VsdHMsIC4uLmhvdGtleXNdO1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRzO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzU2VhcmNoRWwuZGV0YWNoKCk7XG5cbiAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbC5kZXRhY2goKTtcbiAgICAgICAgdGhpcy5kZXRhY2goKTtcbiAgICAgICAgaWYgKHRoaXMuc2VhcmNoQXBwZW5kZWQgJiYgUGxhdGZvcm0uaXNEZXNrdG9wKVxuICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZCh0aGlzLmFwcC5zZXR0aW5nLmxhc3RUYWJJZCk7XG4gICAgfVxufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBhcm91bmQob2JqLCBmYWN0b3JpZXMpIHtcbiAgICBjb25zdCByZW1vdmVycyA9IE9iamVjdC5rZXlzKGZhY3RvcmllcykubWFwKGtleSA9PiBhcm91bmQxKG9iaiwga2V5LCBmYWN0b3JpZXNba2V5XSkpO1xuICAgIHJldHVybiByZW1vdmVycy5sZW5ndGggPT09IDEgPyByZW1vdmVyc1swXSA6IGZ1bmN0aW9uICgpIHsgcmVtb3ZlcnMuZm9yRWFjaChyID0+IHIoKSk7IH07XG59XG5mdW5jdGlvbiBhcm91bmQxKG9iaiwgbWV0aG9kLCBjcmVhdGVXcmFwcGVyKSB7XG4gICAgY29uc3Qgb3JpZ2luYWwgPSBvYmpbbWV0aG9kXSwgaGFkT3duID0gb2JqLmhhc093blByb3BlcnR5KG1ldGhvZCk7XG4gICAgbGV0IGN1cnJlbnQgPSBjcmVhdGVXcmFwcGVyKG9yaWdpbmFsKTtcbiAgICAvLyBMZXQgb3VyIHdyYXBwZXIgaW5oZXJpdCBzdGF0aWMgcHJvcHMgZnJvbSB0aGUgd3JhcHBpbmcgbWV0aG9kLFxuICAgIC8vIGFuZCB0aGUgd3JhcHBpbmcgbWV0aG9kLCBwcm9wcyBmcm9tIHRoZSBvcmlnaW5hbCBtZXRob2RcbiAgICBpZiAob3JpZ2luYWwpXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihjdXJyZW50LCBvcmlnaW5hbCk7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIGN1cnJlbnQpO1xuICAgIG9ialttZXRob2RdID0gd3JhcHBlcjtcbiAgICAvLyBSZXR1cm4gYSBjYWxsYmFjayB0byBhbGxvdyBzYWZlIHJlbW92YWxcbiAgICByZXR1cm4gcmVtb3ZlO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIGJlZW4gZGVhY3RpdmF0ZWQgYW5kIGFyZSBubyBsb25nZXIgd3JhcHBlZCwgcmVtb3ZlIG91cnNlbHZlc1xuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwgJiYgb2JqW21ldGhvZF0gPT09IHdyYXBwZXIpXG4gICAgICAgICAgICByZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgLy8gSWYgbm8gb3RoZXIgcGF0Y2hlcywganVzdCBkbyBhIGRpcmVjdCByZW1vdmFsXG4gICAgICAgIGlmIChvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcikge1xuICAgICAgICAgICAgaWYgKGhhZE93bilcbiAgICAgICAgICAgICAgICBvYmpbbWV0aG9kXSA9IG9yaWdpbmFsO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBvYmpbbWV0aG9kXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIEVsc2UgcGFzcyBmdXR1cmUgY2FsbHMgdGhyb3VnaCwgYW5kIHJlbW92ZSB3cmFwcGVyIGZyb20gdGhlIHByb3RvdHlwZSBjaGFpblxuICAgICAgICBjdXJyZW50ID0gb3JpZ2luYWw7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih3cmFwcGVyLCBvcmlnaW5hbCB8fCBGdW5jdGlvbik7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGRlZHVwZShrZXksIG9sZEZuLCBuZXdGbikge1xuICAgIGNoZWNrW2tleV0gPSBrZXk7XG4gICAgcmV0dXJuIGNoZWNrO1xuICAgIGZ1bmN0aW9uIGNoZWNrKC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIChvbGRGbltrZXldID09PSBrZXkgPyBvbGRGbiA6IG5ld0ZuKS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYWZ0ZXIocHJvbWlzZSwgY2IpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGNiLCBjYik7XG59XG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplKGFzeW5jRnVuY3Rpb24pIHtcbiAgICBsZXQgbGFzdFJ1biA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbGFzdFJ1biA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAgICAgYWZ0ZXIobGFzdFJ1biwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzeW5jRnVuY3Rpb24uYXBwbHkodGhpcywgYXJncykudGhlbihyZXMsIHJlaik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHdyYXBwZXIuYWZ0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7IGFmdGVyKGxhc3RSdW4sIHJlcyk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIHdyYXBwZXI7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQVdPOzs7QUNYQSxn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
