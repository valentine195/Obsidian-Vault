/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};

// src/main.ts
__export(exports, {
  default: () => SettingsSearch
});
var import_obsidian = __toModule(require("obsidian"));

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/main.ts
var SettingsSearch = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "settingsSearchEl", createDiv("settings-search-container vertical-tab-header-group"));
    __publicField(this, "settingsResultsContainerEl", createDiv("settings-search-results-container vertical-tab-content"));
    __publicField(this, "settingsNavItemContainer", this.settingsSearchEl.createDiv("vertical-tab-header-group-items").createDiv("vertical-tab-nav-item settings-search-input"));
    __publicField(this, "settingsResultsEl");
    __publicField(this, "search");
    __publicField(this, "locale");
    __publicField(this, "resources", []);
    __publicField(this, "results", []);
    __publicField(this, "tabIndex", 0);
    __publicField(this, "pluginTabIndex", 0);
    __publicField(this, "settingCache", new Map());
    __publicField(this, "searchAppended", false);
  }
  async onload() {
    this.app.workspace.onLayoutReady(async () => {
      this.settingsResultsContainerEl.createEl("h3", {
        text: "Settings Search Results"
      });
      this.settingsResultsEl = this.settingsResultsContainerEl.createDiv("settings-search-results");
      this.buildSearch();
      this.buildResources();
      this.buildPluginResources();
      this.patchSettings();
    });
  }
  buildResources() {
    const tab = this.app.setting.settingTabs[this.tabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.tabIndex++;
      setImmediate(() => this.buildResources());
    }
  }
  buildPluginResources() {
    const tab = this.app.setting.pluginTabs[this.pluginTabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.pluginTabIndex++;
      setImmediate(() => this.buildPluginResources());
    }
  }
  get manifests() {
    return Object.values(this.app.plugins.manifests);
  }
  addResourceToCache(resource) {
    const setting = new import_obsidian.Setting(createDiv()).setName(resource.text).setDesc(createFragment((e) => e.createDiv().innerHTML = resource.desc ?? ""));
    if (resource.tab == "community-plugins") {
      let plugin = this.manifests.find((p) => p.name == resource.text);
      if (plugin && this.app.plugins.getPlugin(plugin.id)?._loaded && this.app.setting.pluginTabs.find((t) => t.id == plugin.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.id);
          });
        });
      }
    }
    if (resource.tab == "plugins") {
      const plugins = Object.values(this.app.internalPlugins.plugins);
      const plugin = plugins.find((p) => p._loaded && p.instance.name == resource.text);
      if (plugin && this.app.setting.pluginTabs.find((t) => t.id == plugin.instance.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.instance.id);
          });
        });
      }
    }
    setting.addExtraButton((b) => {
      b.setIcon("forward-arrow").onClick(() => {
        this.showResult(resource);
      });
    });
    this.settingCache.set(resource.text, setting);
  }
  getResourceFromCache(resource) {
    if (!this.settingCache.has(resource.text)) {
      this.addResourceToCache(resource);
    }
    return this.settingCache.get(resource.text);
  }
  removeResourcesFromCache(resources) {
    for (const resource of resources) {
      this.settingCache.delete(resource.text);
    }
  }
  getTabResources(tab) {
    tab.display();
    const settings = tab.containerEl.querySelectorAll(".setting-item:not(.setting-item-header)");
    for (const el of Array.from(settings)) {
      const text = el.querySelector(".setting-item-name")?.textContent;
      if (!text)
        continue;
      const desc = el.querySelector(".setting-item-description")?.innerHTML ?? "";
      const resource = {
        tab: tab.id,
        name: tab.name,
        text,
        desc
      };
      this.resources.push(resource);
      this.addResourceToCache(resource);
    }
    if (this.app.setting.activeTab?.id == tab.id)
      return;
    tab.containerEl.detach();
    tab.hide();
  }
  patchSettings() {
    const self = this;
    this.register(around(this.app.setting, {
      onOpen: function(next) {
        return function() {
          next.apply(this);
          self.search.inputEl.focus();
          return next;
        };
      }
    }));
    this.register(around(this.app.setting, {
      addSettingTab: function(next) {
        return function(tab) {
          self.getTabResources(tab);
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      removeSettingTab: function(next) {
        return function(tab) {
          if (this.isPluginSettingTab(tab)) {
            const removing = self.resources.filter((t) => t.tab == tab.id);
            self.resources = self.resources.filter((t) => t.tab != tab.id);
            self.removeResourcesFromCache(removing);
          }
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      openTab: function(next) {
        return function(tab) {
          self.searchAppended = false;
          return next.call(this, tab);
        };
      },
      openTabById: function(next) {
        return function(tab) {
          self.searchAppended = false;
          return next.call(this, tab);
        };
      }
    }));
  }
  buildSearch() {
    const tempSetting = new import_obsidian.Setting(createDiv()).addSearch((s) => {
      this.search = s;
    });
    this.settingsNavItemContainer.append(tempSetting.controlEl);
    tempSetting.settingEl.detach();
    this.search.onChange((v) => {
      this.onChange(v);
    });
    this.search.setPlaceholder("Search settings...");
    this.app.setting.tabHeadersEl.prepend(this.settingsSearchEl);
  }
  onChange(v) {
    if (!v) {
      this.app.setting.openTabById(this.app.setting.lastTabId);
      this.searchAppended = false;
      return;
    }
    if (!this.searchAppended) {
      this.app.setting.activeTab.navEl.removeClass("is-active");
      this.app.setting.tabContentContainer.empty();
      this.app.setting.tabContentContainer.append(this.settingsResultsContainerEl);
      this.searchAppended = true;
    }
    this.appendResults(this.performFuzzySearch(v));
  }
  getMatchText(text, result) {
    const matchElements = {};
    return createFragment((content) => {
      for (let i = 0; i < text.length; i++) {
        let match = result.matches.find((m) => m[0] === i);
        if (match) {
          const index = result.matches.indexOf(match);
          if (!matchElements[index]) {
            matchElements[index] = createSpan("suggestion-highlight");
          }
          let element = matchElements[index];
          content.appendChild(element);
          element.appendText(text.substring(match[0], match[1]));
          i += match[1] - match[0] - 1;
          continue;
        }
        content.appendText(text[i]);
      }
    });
  }
  appendResults(results) {
    this.settingsResultsEl.empty();
    if (results.length) {
      const headers = {};
      for (const resource of results) {
        if (!(resource.tab in headers)) {
          if (resource.tab == "hotkeys") {
            headers[resource.tab] = createDiv();
          } else {
            headers[resource.tab] = this.settingsResultsEl.createDiv();
          }
          new import_obsidian.Setting(headers[resource.tab]).setHeading().setName(resource.name);
        }
        const setting = this.getResourceFromCache(resource);
        headers[resource.tab].append(setting.settingEl);
      }
      if ("hotkeys" in headers) {
        this.settingsResultsEl.appendChild(headers["hotkeys"]);
      }
    } else {
      this.settingsResultsEl.setText("No results found :(");
    }
  }
  showResult(result) {
    this.search.setValue("");
    const tab = this.app.setting.settingTabs.find((t) => t.id == result.tab) ?? this.app.setting.pluginTabs.find((t) => t.id == result.tab);
    if (!tab) {
      new import_obsidian.Notice("There was an issue opening the setting tab.");
      return;
    }
    this.app.setting.openTabById(tab.id);
    try {
      const names = tab.containerEl.querySelectorAll(".setting-item-name");
      const el = Array.from(names).find((n) => n.textContent == result.text);
      if (!el)
        return;
      const setting = el.closest(".setting-item");
      if (!setting)
        return;
      if (tab.id == "obsidian-style-settings") {
        let collapsed = setting.closest(".style-settings-container");
        let previous = collapsed?.previousElementSibling;
        while (previous != null && previous.hasClass("is-collapsed") && previous.hasClass("style-settings-heading")) {
          previous.removeClass("is-collapsed");
          collapsed = collapsed.parentElement?.closest(".style-settings-container");
          previous = collapsed?.previousElementSibling;
        }
      }
      let details = setting.closest("details");
      while (details) {
        details.setAttr("open", "open");
        details = details.parentElement?.closest("details");
      }
      setting.scrollIntoView(true);
      setting.addClass("is-flashing");
      this.registerInterval(window.setTimeout(() => setting.removeClass("is-flashing"), 3e3));
    } catch (e) {
      console.error(e);
    }
  }
  performFuzzySearch(input) {
    const results = [];
    for (const resource of this.resources) {
      let result = (0, import_obsidian.prepareSimpleSearch)(input)(resource.text) ?? (0, import_obsidian.prepareSimpleSearch)(input)(resource.desc);
      if (result) {
        results.push(resource);
      }
    }
    this.results = results;
    return results;
  }
  onunload() {
    this.settingsSearchEl.detach();
    this.settingsResultsEl.detach();
    if (this.searchAppended)
      this.app.setting.openTabById(this.app.setting.lastTabId);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vR2l0SHViL1BlcnNvbmFsL29ic2lkaWFuLXNldHRpbmdzLXNlYXJjaC9zcmMvbWFpbi50cyIsICIuLi8uLi8uLi8uLi9HaXRIdWIvUGVyc29uYWwvb2JzaWRpYW4tc2V0dGluZ3Mtc2VhcmNoL25vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcclxuICAgIFBsdWdpbixcclxuICAgIFNlYXJjaENvbXBvbmVudCxcclxuICAgIFNldHRpbmcsXHJcbiAgICBTZWFyY2hSZXN1bHQsXHJcbiAgICBOb3RpY2UsXHJcbiAgICBwcmVwYXJlU2ltcGxlU2VhcmNoLFxyXG4gICAgU2V0dGluZ1RhYlxyXG59IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuaW1wb3J0IHsgYXJvdW5kIH0gZnJvbSBcIm1vbmtleS1hcm91bmRcIjtcclxuXHJcbmRlY2xhcmUgbW9kdWxlIFwib2JzaWRpYW5cIiB7XHJcbiAgICBpbnRlcmZhY2UgQXBwIHtcclxuICAgICAgICBpbnRlcm5hbFBsdWdpbnM6IHtcclxuICAgICAgICAgICAgcGx1Z2luczogUmVjb3JkPFxyXG4gICAgICAgICAgICAgICAgc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgeyBfbG9hZGVkOiBib29sZWFuOyBpbnN0YW5jZTogeyBuYW1lOiBzdHJpbmc7IGlkOiBzdHJpbmcgfSB9XHJcbiAgICAgICAgICAgID47XHJcbiAgICAgICAgfTtcclxuICAgICAgICBwbHVnaW5zOiB7XHJcbiAgICAgICAgICAgIG1hbmlmZXN0czogUmVjb3JkPHN0cmluZywgUGx1Z2luTWFuaWZlc3Q+O1xyXG4gICAgICAgICAgICBwbHVnaW5zOiBSZWNvcmQ8c3RyaW5nLCBQbHVnaW4+O1xyXG4gICAgICAgICAgICBnZXRQbHVnaW4oaWQ6IHN0cmluZyk6IFBsdWdpbjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHNldHRpbmc6IHtcclxuICAgICAgICAgICAgb25PcGVuKCk6IHZvaWQ7XHJcblxyXG4gICAgICAgICAgICBvcGVuVGFiQnlJZChpZDogc3RyaW5nKTogdm9pZDtcclxuICAgICAgICAgICAgb3BlblRhYih0YWI6IFNldHRpbmdUYWIpOiB2b2lkO1xyXG5cclxuICAgICAgICAgICAgaXNQbHVnaW5TZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IGJvb2xlYW47XHJcbiAgICAgICAgICAgIGFkZFNldHRpbmdUYWIodGFiOiBTZXR0aW5nVGFiKTogdm9pZDtcclxuICAgICAgICAgICAgcmVtb3ZlU2V0dGluZ1RhYih0YWI6IFNldHRpbmdUYWIpOiB2b2lkO1xyXG5cclxuICAgICAgICAgICAgYWN0aXZlVGFiOiBTZXR0aW5nVGFiO1xyXG4gICAgICAgICAgICBsYXN0VGFiSWQ6IHN0cmluZztcclxuXHJcbiAgICAgICAgICAgIHBsdWdpblRhYnM6IFBsdWdpblNldHRpbmdUYWJbXTtcclxuICAgICAgICAgICAgc2V0dGluZ1RhYnM6IFNldHRpbmdUYWJbXTtcclxuXHJcbiAgICAgICAgICAgIHRhYkNvbnRlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgICAgICB0YWJIZWFkZXJzRWw6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBpbnRlcmZhY2UgUGx1Z2luIHtcclxuICAgICAgICBfbG9hZGVkOiBib29sZWFuO1xyXG4gICAgfVxyXG4gICAgaW50ZXJmYWNlIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgICAgIG5hbWU6IHN0cmluZztcclxuICAgIH1cclxuICAgIGludGVyZmFjZSBTZXR0aW5nVGFiIHtcclxuICAgICAgICBpZDogc3RyaW5nO1xyXG4gICAgICAgIG5hbWU6IHN0cmluZztcclxuICAgICAgICBuYXZFbDogSFRNTEVsZW1lbnQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBSZXNvdXJjZSB7XHJcbiAgICB0YWI6IHN0cmluZztcclxuICAgIHRleHQ6IHN0cmluZztcclxuICAgIGRlc2M6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxufVxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXR0aW5nc1NlYXJjaCBleHRlbmRzIFBsdWdpbiB7XHJcbiAgICBzZXR0aW5nc1NlYXJjaEVsOiBIVE1MRGl2RWxlbWVudCA9IGNyZWF0ZURpdihcclxuICAgICAgICBcInNldHRpbmdzLXNlYXJjaC1jb250YWluZXIgdmVydGljYWwtdGFiLWhlYWRlci1ncm91cFwiXHJcbiAgICApO1xyXG4gICAgc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwgPSBjcmVhdGVEaXYoXHJcbiAgICAgICAgXCJzZXR0aW5ncy1zZWFyY2gtcmVzdWx0cy1jb250YWluZXIgdmVydGljYWwtdGFiLWNvbnRlbnRcIlxyXG4gICAgKTtcclxuICAgIHNldHRpbmdzTmF2SXRlbUNvbnRhaW5lciA9IHRoaXMuc2V0dGluZ3NTZWFyY2hFbFxyXG4gICAgICAgIC5jcmVhdGVEaXYoXCJ2ZXJ0aWNhbC10YWItaGVhZGVyLWdyb3VwLWl0ZW1zXCIpXHJcbiAgICAgICAgLmNyZWF0ZURpdihcInZlcnRpY2FsLXRhYi1uYXYtaXRlbSBzZXR0aW5ncy1zZWFyY2gtaW5wdXRcIik7XHJcbiAgICBzZXR0aW5nc1Jlc3VsdHNFbDogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBzZWFyY2g6IFNlYXJjaENvbXBvbmVudDtcclxuICAgIGxvY2FsZTogc3RyaW5nO1xyXG5cclxuICAgIHJlc291cmNlczogUmVzb3VyY2VbXSA9IFtdO1xyXG4gICAgcmVzdWx0czogUmVzb3VyY2VbXSA9IFtdO1xyXG5cclxuICAgIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeShhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIlNldHRpbmdzIFNlYXJjaCBSZXN1bHRzXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwgPSB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsLmNyZWF0ZURpdihcclxuICAgICAgICAgICAgICAgIFwic2V0dGluZ3Mtc2VhcmNoLXJlc3VsdHNcIlxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5idWlsZFNlYXJjaCgpO1xyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkUmVzb3VyY2VzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYnVpbGRQbHVnaW5SZXNvdXJjZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5wYXRjaFNldHRpbmdzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICB0YWJJbmRleCA9IDA7XHJcbiAgICBwbHVnaW5UYWJJbmRleCA9IDA7XHJcbiAgICBidWlsZFJlc291cmNlcygpIHtcclxuICAgICAgICBjb25zdCB0YWIgPSB0aGlzLmFwcC5zZXR0aW5nLnNldHRpbmdUYWJzW3RoaXMudGFiSW5kZXhdO1xyXG4gICAgICAgIGlmICh0YWIpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRUYWJSZXNvdXJjZXModGFiKTtcclxuICAgICAgICAgICAgdGhpcy50YWJJbmRleCsrO1xyXG4gICAgICAgICAgICBzZXRJbW1lZGlhdGUoKCkgPT4gdGhpcy5idWlsZFJlc291cmNlcygpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBidWlsZFBsdWdpblJlc291cmNlcygpIHtcclxuICAgICAgICBjb25zdCB0YWIgPSB0aGlzLmFwcC5zZXR0aW5nLnBsdWdpblRhYnNbdGhpcy5wbHVnaW5UYWJJbmRleF07XHJcbiAgICAgICAgaWYgKHRhYikge1xyXG4gICAgICAgICAgICB0aGlzLmdldFRhYlJlc291cmNlcyh0YWIpO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpblRhYkluZGV4Kys7XHJcbiAgICAgICAgICAgIHNldEltbWVkaWF0ZSgoKSA9PiB0aGlzLmJ1aWxkUGx1Z2luUmVzb3VyY2VzKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBtYW5pZmVzdHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5hcHAucGx1Z2lucy5tYW5pZmVzdHMpO1xyXG4gICAgfVxyXG4gICAgc2V0dGluZ0NhY2hlOiBNYXA8c3RyaW5nLCBTZXR0aW5nPiA9IG5ldyBNYXAoKTtcclxuICAgIGFkZFJlc291cmNlVG9DYWNoZShyZXNvdXJjZTogUmVzb3VyY2UpIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY3JlYXRlRGl2KCkpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKHJlc291cmNlLnRleHQpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlRnJhZ21lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgKGUpID0+IChlLmNyZWF0ZURpdigpLmlubmVySFRNTCA9IHJlc291cmNlLmRlc2MgPz8gXCJcIilcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKHJlc291cmNlLnRhYiA9PSBcImNvbW11bml0eS1wbHVnaW5zXCIpIHtcclxuICAgICAgICAgICAgbGV0IHBsdWdpbiA9IHRoaXMubWFuaWZlc3RzLmZpbmQoKHApID0+IHAubmFtZSA9PSByZXNvdXJjZS50ZXh0KTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgcGx1Z2luICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5wbHVnaW5zLmdldFBsdWdpbihwbHVnaW4uaWQpPy5fbG9hZGVkICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnBsdWdpblRhYnMuZmluZCgodCkgPT4gdC5pZCA9PSBwbHVnaW4uaWQpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbigoYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc2V0VG9vbHRpcChgT3BlbiAke3Jlc291cmNlLnRleHR9IFNldHRpbmdzYCkub25DbGljayhcclxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZChwbHVnaW4uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXNvdXJjZS50YWIgPT0gXCJwbHVnaW5zXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgcGx1Z2lucyA9IE9iamVjdC52YWx1ZXModGhpcy5hcHAuaW50ZXJuYWxQbHVnaW5zLnBsdWdpbnMpO1xyXG4gICAgICAgICAgICBjb25zdCBwbHVnaW4gPSBwbHVnaW5zLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAocCkgPT4gcC5fbG9hZGVkICYmIHAuaW5zdGFuY2UubmFtZSA9PSByZXNvdXJjZS50ZXh0XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBwbHVnaW4gJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcucGx1Z2luVGFicy5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LmlkID09IHBsdWdpbi5pbnN0YW5jZS5pZFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHNldHRpbmcuYWRkRXh0cmFCdXR0b24oKGIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBiLnNldFRvb2x0aXAoYE9wZW4gJHtyZXNvdXJjZS50ZXh0fSBTZXR0aW5nc2ApLm9uQ2xpY2soXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQocGx1Z2luLmluc3RhbmNlLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzZXR0aW5nLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB7XHJcbiAgICAgICAgICAgIGIuc2V0SWNvbihcImZvcndhcmQtYXJyb3dcIikub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSZXN1bHQocmVzb3VyY2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldHRpbmdDYWNoZS5zZXQocmVzb3VyY2UudGV4dCwgc2V0dGluZyk7XHJcbiAgICB9XHJcbiAgICBnZXRSZXNvdXJjZUZyb21DYWNoZShyZXNvdXJjZTogUmVzb3VyY2UpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ0NhY2hlLmhhcyhyZXNvdXJjZS50ZXh0KSkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZFJlc291cmNlVG9DYWNoZShyZXNvdXJjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdDYWNoZS5nZXQocmVzb3VyY2UudGV4dCk7XHJcbiAgICB9XHJcbiAgICByZW1vdmVSZXNvdXJjZXNGcm9tQ2FjaGUocmVzb3VyY2VzOiBSZXNvdXJjZVtdKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCByZXNvdXJjZSBvZiByZXNvdXJjZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5nQ2FjaGUuZGVsZXRlKHJlc291cmNlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldFRhYlJlc291cmNlcyh0YWI6IFNldHRpbmdUYWIpIHtcclxuICAgICAgICB0YWIuZGlzcGxheSgpO1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGFiLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTERpdkVsZW1lbnQ+KFxyXG4gICAgICAgICAgICBcIi5zZXR0aW5nLWl0ZW06bm90KC5zZXR0aW5nLWl0ZW0taGVhZGVyKVwiXHJcbiAgICAgICAgKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGVsIG9mIEFycmF5LmZyb20oc2V0dGluZ3MpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPVxyXG4gICAgICAgICAgICAgICAgZWwucXVlcnlTZWxlY3RvcjxIVE1MRGl2RWxlbWVudD4oXHJcbiAgICAgICAgICAgICAgICAgICAgXCIuc2V0dGluZy1pdGVtLW5hbWVcIlxyXG4gICAgICAgICAgICAgICAgKT8udGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIGlmICghdGV4dCkgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBkZXNjID1cclxuICAgICAgICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3I8SFRNTERpdkVsZW1lbnQ+KFwiLnNldHRpbmctaXRlbS1kZXNjcmlwdGlvblwiKVxyXG4gICAgICAgICAgICAgICAgICAgID8uaW5uZXJIVE1MID8/IFwiXCI7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXNvdXJjZSA9IHtcclxuICAgICAgICAgICAgICAgIHRhYjogdGFiLmlkLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogdGFiLm5hbWUsXHJcbiAgICAgICAgICAgICAgICB0ZXh0LFxyXG4gICAgICAgICAgICAgICAgZGVzY1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZXMucHVzaChyZXNvdXJjZSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkUmVzb3VyY2VUb0NhY2hlKHJlc291cmNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuYXBwLnNldHRpbmcuYWN0aXZlVGFiPy5pZCA9PSB0YWIuaWQpIHJldHVybjtcclxuICAgICAgICB0YWIuY29udGFpbmVyRWwuZGV0YWNoKCk7XHJcbiAgICAgICAgdGFiLmhpZGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBwYXRjaFNldHRpbmdzKCkge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICAgICAgICBhcm91bmQodGhpcy5hcHAuc2V0dGluZywge1xyXG4gICAgICAgICAgICAgICAgb25PcGVuOiBmdW5jdGlvbiAobmV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQuYXBwbHkodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoLmlucHV0RWwuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvL1BhdGNoIGFkZFNldHRpbmdUYWIgdG8gY2FwdHVyZSBjaGFuZ2VzIHRvIHBsdWdpbiBzZXR0aW5ncy5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICAgICAgICBhcm91bmQodGhpcy5hcHAuc2V0dGluZywge1xyXG4gICAgICAgICAgICAgICAgYWRkU2V0dGluZ1RhYjogZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogU2V0dGluZ1RhYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdldFRhYlJlc291cmNlcyh0YWIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMsIHRhYik7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvL1BhdGNoIHJlbW92ZVNldHRpbmdUYWIgdG8gY2FwdHVyZSBjaGFuZ2VzIHRvIHBsdWdpbiBzZXR0aW5ncy5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyKFxyXG4gICAgICAgICAgICBhcm91bmQodGhpcy5hcHAuc2V0dGluZywge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlU2V0dGluZ1RhYjogZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogU2V0dGluZ1RhYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BsdWdpblNldHRpbmdUYWIodGFiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZpbmcgPSBzZWxmLnJlc291cmNlcy5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQpID0+IHQudGFiID09IHRhYi5pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucmVzb3VyY2VzID0gc2VsZi5yZXNvdXJjZXMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LnRhYiAhPSB0YWIuaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZVJlc291cmNlc0Zyb21DYWNoZShyZW1vdmluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FsbCh0aGlzLCB0YWIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcihcclxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcclxuICAgICAgICAgICAgICAgIG9wZW5UYWI6IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YWI6IFNldHRpbmdUYWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWFyY2hBcHBlbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMsIHRhYik7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvcGVuVGFiQnlJZDogZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogc3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoQXBwZW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FsbCh0aGlzLCB0YWIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZFNlYXJjaCgpIHtcclxuICAgICAgICBjb25zdCB0ZW1wU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNyZWF0ZURpdigpKS5hZGRTZWFyY2goKHMpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSBzO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNldHRpbmdzTmF2SXRlbUNvbnRhaW5lci5hcHBlbmQodGVtcFNldHRpbmcuY29udHJvbEVsKTtcclxuXHJcbiAgICAgICAgdGVtcFNldHRpbmcuc2V0dGluZ0VsLmRldGFjaCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNlYXJjaC5vbkNoYW5nZSgodikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKHYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoLnNldFBsYWNlaG9sZGVyKFwiU2VhcmNoIHNldHRpbmdzLi4uXCIpO1xyXG4gICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiSGVhZGVyc0VsLnByZXBlbmQodGhpcy5zZXR0aW5nc1NlYXJjaEVsKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2hBcHBlbmRlZCA9IGZhbHNlO1xyXG4gICAgb25DaGFuZ2Uodjogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQodGhpcy5hcHAuc2V0dGluZy5sYXN0VGFiSWQpO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaEFwcGVuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlYXJjaEFwcGVuZGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcuYWN0aXZlVGFiLm5hdkVsLnJlbW92ZUNsYXNzKFwiaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkNvbnRlbnRDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJDb250ZW50Q29udGFpbmVyLmFwcGVuZChcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2hBcHBlbmRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXBwZW5kUmVzdWx0cyh0aGlzLnBlcmZvcm1GdXp6eVNlYXJjaCh2KSk7XHJcbiAgICB9XHJcbiAgICBnZXRNYXRjaFRleHQodGV4dDogc3RyaW5nLCByZXN1bHQ6IFNlYXJjaFJlc3VsdCkge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoRWxlbWVudHM6IFJlY29yZDxudW1iZXIsIEhUTUxFbGVtZW50PiA9IHt9O1xyXG4gICAgICAgIHJldHVybiBjcmVhdGVGcmFnbWVudCgoY29udGVudCkgPT4ge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCBtYXRjaCA9IHJlc3VsdC5tYXRjaGVzLmZpbmQoKG0pID0+IG1bMF0gPT09IGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSByZXN1bHQubWF0Y2hlcy5pbmRleE9mKG1hdGNoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1hdGNoRWxlbWVudHNbaW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoRWxlbWVudHNbaW5kZXhdID0gY3JlYXRlU3BhbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3VnZ2VzdGlvbi1oaWdobGlnaHRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgZWxlbWVudCA9IG1hdGNoRWxlbWVudHNbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRUZXh0KHRleHQuc3Vic3RyaW5nKG1hdGNoWzBdLCBtYXRjaFsxXSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpICs9IG1hdGNoWzFdIC0gbWF0Y2hbMF0gLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kVGV4dCh0ZXh0W2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXBwZW5kUmVzdWx0cyhyZXN1bHRzOiBSZXNvdXJjZVtdKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbC5lbXB0eSgpO1xyXG4gICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBIVE1MRWxlbWVudD4gPSB7fTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByZXNvdXJjZSBvZiByZXN1bHRzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShyZXNvdXJjZS50YWIgaW4gaGVhZGVycykpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UudGFiID09IFwiaG90a2V5c1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbcmVzb3VyY2UudGFiXSA9IGNyZWF0ZURpdigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbcmVzb3VyY2UudGFiXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0VsLmNyZWF0ZURpdigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXcgU2V0dGluZyhoZWFkZXJzW3Jlc291cmNlLnRhYl0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRIZWFkaW5nKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldE5hbWUocmVzb3VyY2UubmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZyA9IHRoaXMuZ2V0UmVzb3VyY2VGcm9tQ2FjaGUocmVzb3VyY2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIGhlYWRlcnNbcmVzb3VyY2UudGFiXS5hcHBlbmQoc2V0dGluZy5zZXR0aW5nRWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChcImhvdGtleXNcIiBpbiBoZWFkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0VsLmFwcGVuZENoaWxkKGhlYWRlcnNbXCJob3RrZXlzXCJdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuc2V0VGV4dChcIk5vIHJlc3VsdHMgZm91bmQgOihcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNob3dSZXN1bHQocmVzdWx0OiBSZXNvdXJjZSkge1xyXG4gICAgICAgIHRoaXMuc2VhcmNoLnNldFZhbHVlKFwiXCIpO1xyXG4gICAgICAgIGNvbnN0IHRhYiA9XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcuc2V0dGluZ1RhYnMuZmluZCgodCkgPT4gdC5pZCA9PSByZXN1bHQudGFiKSA/P1xyXG4gICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnBsdWdpblRhYnMuZmluZCgodCkgPT4gdC5pZCA9PSByZXN1bHQudGFiKTtcclxuICAgICAgICBpZiAoIXRhYikge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiVGhlcmUgd2FzIGFuIGlzc3VlIG9wZW5pbmcgdGhlIHNldHRpbmcgdGFiLlwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZCh0YWIuaWQpO1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBuYW1lcyA9XHJcbiAgICAgICAgICAgICAgICB0YWIuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbChcIi5zZXR0aW5nLWl0ZW0tbmFtZVwiKTtcclxuICAgICAgICAgICAgY29uc3QgZWwgPSBBcnJheS5mcm9tKG5hbWVzKS5maW5kKFxyXG4gICAgICAgICAgICAgICAgKG4pID0+IG4udGV4dENvbnRlbnQgPT0gcmVzdWx0LnRleHRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKCFlbCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2V0dGluZyA9IGVsLmNsb3Nlc3QoXCIuc2V0dGluZy1pdGVtXCIpO1xyXG4gICAgICAgICAgICBpZiAoIXNldHRpbmcpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmICh0YWIuaWQgPT0gXCJvYnNpZGlhbi1zdHlsZS1zZXR0aW5nc1wiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY29sbGFwc2VkID0gc2V0dGluZy5jbG9zZXN0KFwiLnN0eWxlLXNldHRpbmdzLWNvbnRhaW5lclwiKTtcclxuICAgICAgICAgICAgICAgIGxldCBwcmV2aW91cyA9IGNvbGxhcHNlZD8ucHJldmlvdXNFbGVtZW50U2libGluZztcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMgIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLmhhc0NsYXNzKFwiaXMtY29sbGFwc2VkXCIpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMuaGFzQ2xhc3MoXCJzdHlsZS1zZXR0aW5ncy1oZWFkaW5nXCIpXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91cy5yZW1vdmVDbGFzcyhcImlzLWNvbGxhcHNlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZWQgPSBjb2xsYXBzZWQucGFyZW50RWxlbWVudD8uY2xvc2VzdChcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCIuc3R5bGUtc2V0dGluZ3MtY29udGFpbmVyXCJcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0gY29sbGFwc2VkPy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgZGV0YWlscyA9IHNldHRpbmcuY2xvc2VzdChcImRldGFpbHNcIik7XHJcbiAgICAgICAgICAgIHdoaWxlIChkZXRhaWxzKSB7XHJcbiAgICAgICAgICAgICAgICBkZXRhaWxzLnNldEF0dHIoXCJvcGVuXCIsIFwib3BlblwiKTtcclxuICAgICAgICAgICAgICAgIGRldGFpbHMgPSBkZXRhaWxzLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoXCJkZXRhaWxzXCIpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXR0aW5nLnNjcm9sbEludG9WaWV3KHRydWUpO1xyXG5cclxuICAgICAgICAgICAgc2V0dGluZy5hZGRDbGFzcyhcImlzLWZsYXNoaW5nXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVySW50ZXJ2YWwoXHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChcclxuICAgICAgICAgICAgICAgICAgICAoKSA9PiBzZXR0aW5nLnJlbW92ZUNsYXNzKFwiaXMtZmxhc2hpbmdcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgMzAwMFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcGVyZm9ybUZ1enp5U2VhcmNoKGlucHV0OiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCByZXN1bHRzOiBSZXNvdXJjZVtdID0gW107XHJcbiAgICAgICAgZm9yIChjb25zdCByZXNvdXJjZSBvZiB0aGlzLnJlc291cmNlcykge1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID1cclxuICAgICAgICAgICAgICAgIHByZXBhcmVTaW1wbGVTZWFyY2goaW5wdXQpKHJlc291cmNlLnRleHQpID8/XHJcbiAgICAgICAgICAgICAgICBwcmVwYXJlU2ltcGxlU2VhcmNoKGlucHV0KShyZXNvdXJjZS5kZXNjKTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc291cmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlc3VsdHMgPSByZXN1bHRzO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIG9udW5sb2FkKCkge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3NTZWFyY2hFbC5kZXRhY2goKTtcclxuICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0VsLmRldGFjaCgpO1xyXG4gICAgICAgIGlmICh0aGlzLnNlYXJjaEFwcGVuZGVkKVxyXG4gICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKHRoaXMuYXBwLnNldHRpbmcubGFzdFRhYklkKTtcclxuICAgIH1cclxufVxyXG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGFyb3VuZChvYmosIGZhY3Rvcmllcykge1xuICAgIGNvbnN0IHJlbW92ZXJzID0gT2JqZWN0LmtleXMoZmFjdG9yaWVzKS5tYXAoa2V5ID0+IGFyb3VuZDEob2JqLCBrZXksIGZhY3Rvcmllc1trZXldKSk7XG4gICAgcmV0dXJuIHJlbW92ZXJzLmxlbmd0aCA9PT0gMSA/IHJlbW92ZXJzWzBdIDogZnVuY3Rpb24gKCkgeyByZW1vdmVycy5mb3JFYWNoKHIgPT4gcigpKTsgfTtcbn1cbmZ1bmN0aW9uIGFyb3VuZDEob2JqLCBtZXRob2QsIGNyZWF0ZVdyYXBwZXIpIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9IG9ialttZXRob2RdLCBoYWRPd24gPSBvYmouaGFzT3duUHJvcGVydHkobWV0aG9kKTtcbiAgICBsZXQgY3VycmVudCA9IGNyZWF0ZVdyYXBwZXIob3JpZ2luYWwpO1xuICAgIC8vIExldCBvdXIgd3JhcHBlciBpbmhlcml0IHN0YXRpYyBwcm9wcyBmcm9tIHRoZSB3cmFwcGluZyBtZXRob2QsXG4gICAgLy8gYW5kIHRoZSB3cmFwcGluZyBtZXRob2QsIHByb3BzIGZyb20gdGhlIG9yaWdpbmFsIG1ldGhvZFxuICAgIGlmIChvcmlnaW5hbClcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGN1cnJlbnQsIG9yaWdpbmFsKTtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yod3JhcHBlciwgY3VycmVudCk7XG4gICAgb2JqW21ldGhvZF0gPSB3cmFwcGVyO1xuICAgIC8vIFJldHVybiBhIGNhbGxiYWNrIHRvIGFsbG93IHNhZmUgcmVtb3ZhbFxuICAgIHJldHVybiByZW1vdmU7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYmVlbiBkZWFjdGl2YXRlZCBhbmQgYXJlIG5vIGxvbmdlciB3cmFwcGVkLCByZW1vdmUgb3Vyc2VsdmVzXG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbCAmJiBvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcilcbiAgICAgICAgICAgIHJlbW92ZSgpO1xuICAgICAgICByZXR1cm4gY3VycmVudC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAvLyBJZiBubyBvdGhlciBwYXRjaGVzLCBqdXN0IGRvIGEgZGlyZWN0IHJlbW92YWxcbiAgICAgICAgaWYgKG9ialttZXRob2RdID09PSB3cmFwcGVyKSB7XG4gICAgICAgICAgICBpZiAoaGFkT3duKVxuICAgICAgICAgICAgICAgIG9ialttZXRob2RdID0gb3JpZ2luYWw7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIG9ialttZXRob2RdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gRWxzZSBwYXNzIGZ1dHVyZSBjYWxscyB0aHJvdWdoLCBhbmQgcmVtb3ZlIHdyYXBwZXIgZnJvbSB0aGUgcHJvdG90eXBlIGNoYWluXG4gICAgICAgIGN1cnJlbnQgPSBvcmlnaW5hbDtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIG9yaWdpbmFsIHx8IEZ1bmN0aW9uKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZGVkdXBlKGtleSwgb2xkRm4sIG5ld0ZuKSB7XG4gICAgY2hlY2tba2V5XSA9IGtleTtcbiAgICByZXR1cm4gY2hlY2s7XG4gICAgZnVuY3Rpb24gY2hlY2soLi4uYXJncykge1xuICAgICAgICByZXR1cm4gKG9sZEZuW2tleV0gPT09IGtleSA/IG9sZEZuIDogbmV3Rm4pLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhZnRlcihwcm9taXNlLCBjYikge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2IsIGNiKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemUoYXN5bmNGdW5jdGlvbikge1xuICAgIGxldCBsYXN0UnVuID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBhZnRlcihsYXN0UnVuLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXN5bmNGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmdzKS50aGVuKHJlcywgcmVqKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgd3JhcHBlci5hZnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGxhc3RSdW4gPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsgYWZ0ZXIobGFzdFJ1biwgcmVzKTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBUU87OztBQ1JBLGdCQUFnQixLQUFLLFdBQVc7QUFDbkMsUUFBTSxXQUFXLE9BQU8sS0FBSyxXQUFXLElBQUksU0FBTyxRQUFRLEtBQUssS0FBSyxVQUFVO0FBQy9FLFNBQU8sU0FBUyxXQUFXLElBQUksU0FBUyxLQUFLLFdBQVk7QUFBRSxhQUFTLFFBQVEsT0FBSztBQUFBO0FBQUE7QUFFckYsaUJBQWlCLEtBQUssUUFBUSxlQUFlO0FBQ3pDLFFBQU0sV0FBVyxJQUFJLFNBQVMsU0FBUyxJQUFJLGVBQWU7QUFDMUQsTUFBSSxVQUFVLGNBQWM7QUFHNUIsTUFBSTtBQUNBLFdBQU8sZUFBZSxTQUFTO0FBQ25DLFNBQU8sZUFBZSxTQUFTO0FBQy9CLE1BQUksVUFBVTtBQUVkLFNBQU87QUFDUCxzQkFBb0IsTUFBTTtBQUV0QixRQUFJLFlBQVksWUFBWSxJQUFJLFlBQVk7QUFDeEM7QUFDSixXQUFPLFFBQVEsTUFBTSxNQUFNO0FBQUE7QUFFL0Isb0JBQWtCO0FBRWQsUUFBSSxJQUFJLFlBQVksU0FBUztBQUN6QixVQUFJO0FBQ0Es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
